<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OurSales ‚Ä¢ Configura√ß√µes</title>
    <!-- Resource Hints -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" />
    <link rel="preconnect" href="https://cdn.sheetjs.com" />
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
    <link rel="dns-prefetch" href="https://cdn.sheetjs.com" />
    <!-- Critical CSS -->
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/fix-animations.css" />
    <!-- Defer non-critical CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/dist/tabler-icons.min.css" data-defer />
    <!-- Performance Optimizer (load early) -->
    <script src="assets/js/performance-optimizer.js"></script>
    <!-- Defer heavy libraries (SheetJS s√≥ carrega quando necess√°rio) -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js" defer></script>
    <style>
      .config-container {
        display: flex;
        gap: var(--space-6);
        min-height: calc(100vh - 200px);
      }

      .config-sidebar {
        width: 280px;
        flex-shrink: 0;
        background: var(--gray-50);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
        height: fit-content;
        position: sticky;
        top: var(--space-4);
      }

      .config-sidebar h3 {
        font-size: var(--text-sm);
        font-weight: 600;
        color: var(--gray-600);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: var(--space-3);
        padding: 0 var(--space-2);
      }

      .config-menu {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .config-menu-item {
        margin-bottom: var(--space-1);
      }

      .config-menu-link {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-2) var(--space-3);
        color: var(--gray-700);
        text-decoration: none;
        border-radius: var(--radius-md);
        transition: all 0.2s;
        font-size: var(--text-sm);
      }

      .config-menu-link:hover {
        background: var(--gray-100);
        color: var(--primary-600);
      }

      .config-menu-link.active {
        background: var(--primary-50);
        color: var(--primary-600);
        font-weight: 500;
      }

      .config-menu-link.locked {
        opacity: 0.5;
        cursor: not-allowed;
        position: relative;
      }

      .config-menu-link.locked::after {
        content: "üîí";
        margin-left: auto;
        font-size: var(--text-xs);
      }

      /* Links de personalizar campos */
      .personalizar-campo-link {
        display: flex;
        align-items: center;
        padding: var(--space-3) var(--space-4);
        color: var(--primary-600);
        text-decoration: none;
        border-radius: var(--radius-md);
        transition: all var(--transition-fast);
        font-size: var(--text-base);
        font-weight: 500;
        background: transparent;
        border: 1px solid transparent;
      }

      .personalizar-campo-link:hover {
        background: var(--primary-50);
        border-color: var(--primary-200);
        color: var(--primary-700);
        transform: translateX(4px);
      }

      .personalizar-campo-link strong {
        font-weight: 600;
        color: inherit;
      }

      .config-content {
        flex: 1;
        background: white;
        border-radius: var(--radius-lg);
        padding: var(--space-6);
      }

      .config-section {
        display: none;
      }

      .config-section.active {
        display: block;
      }

      .config-section-header {
        margin-bottom: var(--space-6);
      }

      .config-section-header h2 {
        font-size: var(--text-2xl);
        font-weight: 600;
        color: var(--gray-900);
        margin-bottom: var(--space-2);
      }

      .config-section-header p {
        color: var(--gray-600);
        font-size: var(--text-base);
      }

      .access-denied {
        text-align: center;
        padding: var(--space-8);
        color: var(--gray-500);
      }

      .access-denied-icon {
        font-size: 48px;
        margin-bottom: var(--space-4);
      }

      .access-denied h3 {
        font-size: var(--text-xl);
        margin-bottom: var(--space-2);
      }

      .access-denied p {
        color: var(--gray-600);
      }

      /* Estilos para Importar Produtos, Ind√∫strias, Contatos, Faturamento, Fotos, Formas de Pagamento, Transportadoras, Pedido R√°pido e Grupo de Conta */
      .import-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 2rem;
      }

      .import-steps {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-bottom: 2rem;
      }

      .step-card {
        background: white;
        border-radius: 8px;
        padding: 2rem;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        border: 1px solid #e1e8ed;
      }

      .step-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .step-number {
        background: #3498db;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
        font-weight: 600;
      }

      .step-description {
        color: #7f8c8d;
        margin-bottom: 1.5rem;
        line-height: 1.5;
      }

      .download-template-btn {
        background: #27ae60;
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
        transition: background-color 0.2s;
      }

      .download-template-btn:hover {
        background: #229954;
      }

      .download-options {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      .download-options .download-template-btn {
        flex: 1;
        margin-bottom: 0;
      }

      .fields-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1.5rem;
      }

      .fields-table th,
      .fields-table td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid #e1e8ed;
      }

      .fields-table th {
        background: #f8f9fa;
        font-weight: 600;
        color: #2c3e50;
      }

      .fields-table td {
        color: #5a6c7d;
      }

      .field-checkbox {
        margin-right: 0.5rem;
      }

      .field-checkbox:disabled {
        cursor: not-allowed;
        opacity: 0.7;
      }

      .field-name {
        font-weight: 500;
        color: #2c3e50;
      }

      .field-observation {
        font-size: 0.875rem;
        color: #7f8c8d;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-group label {
        display: block;
        font-weight: 500;
        color: #2c3e50;
        margin-bottom: 0.5rem;
      }

      .form-group select,
      .form-group input[type="file"] {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 1rem;
        background: white;
      }

      .form-group select:focus,
      .form-group input[type="file"]:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
      }

      .file-input-container {
        position: relative;
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .file-input {
        flex: 1;
      }

      .browse-btn {
        background: #95a5a6;
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        transition: background-color 0.2s;
      }

      .browse-btn:hover {
        background: #7f8c8d;
      }

      .import-btn {
        background: #27ae60;
        color: white;
        border: none;
        padding: 1rem 2rem;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 600;
        font-size: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: background-color 0.2s;
      }

      .import-btn:hover {
        background: #229954;
      }

      @media (max-width: 768px) {
        .import-steps {
          grid-template-columns: 1fr;
        }

        .import-container {
          padding: 1rem;
        }

        .file-input-container {
          flex-direction: column;
          align-items: stretch;
        }

        .download-options {
          flex-direction: column;
        }
      }

      #importar-produtos-content,
      #importar-industrias-content,
      #importar-contatos-content,
      #importar-faturamento-content,
      #importar-fotos-content,
      #importar-formas-pagamento-content,
      #importar-transportadoras-content,
      #importar-pedido-rapido-content,
      #importar-grupo-conta-content {
        margin-top: var(--space-4);
      }

      #importar-produtos-content .import-steps,
      #importar-industrias-content .import-steps,
      #importar-contatos-content .import-steps,
      #importar-faturamento-content .import-steps,
      #importar-fotos-content .import-steps,
      #importar-formas-pagamento-content .import-steps,
      #importar-transportadoras-content .import-steps,
      #importar-pedido-rapido-content .import-steps,
      #importar-grupo-conta-content .import-steps {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-5);
        margin-top: var(--space-4);
        align-items: start;
      }

      @media (max-width: 1200px) {
        #importar-produtos-content .import-steps,
        #importar-industrias-content .import-steps,
        #importar-contatos-content .import-steps,
        #importar-faturamento-content .import-steps,
        #importar-fotos-content .import-steps,
        #importar-formas-pagamento-content .import-steps,
        #importar-transportadoras-content .import-steps,
        #importar-pedido-rapido-content .import-steps,
        #importar-grupo-conta-content .import-steps {
          grid-template-columns: 1fr;
        }
      }

      .step-card {
        background: white;
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        transition: box-shadow 0.2s;
        display: flex;
        flex-direction: column;
        height: 100%;
      }

      .step-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      }

      .step-title {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        font-size: var(--text-lg);
        font-weight: 600;
        color: var(--gray-900);
        margin-bottom: var(--space-3);
      }

      .step-number {
        background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
        color: white;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--text-sm);
        font-weight: 600;
        flex-shrink: 0;
      }

      .step-description {
        color: var(--gray-600);
        margin-bottom: var(--space-4);
        line-height: 1.6;
        font-size: var(--text-sm);
      }

      .step-card .step-description:last-of-type {
        margin-bottom: var(--space-3);
      }

      .download-options {
        display: flex;
        gap: var(--space-3);
        margin-bottom: var(--space-4);
        flex-wrap: wrap;
      }

      .download-template-btn {
        width: 100%;
        background: linear-gradient(135deg, var(--emerald-500), var(--emerald-600));
        color: white;
        border: none;
        padding: var(--space-3) var(--space-4);
        border-radius: var(--radius-md);
        cursor: pointer;
        font-weight: 500;
        font-size: var(--text-sm);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        transition: all 0.2s;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        white-space: normal;
        line-height: 1.4;
        text-align: center;
        word-break: break-word;
        min-height: 44px;
      }

      .download-template-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }

      .download-template-btn:active {
        transform: translateY(0);
      }

      .fields-table-wrapper {
        max-height: 500px;
        overflow-y: auto;
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-md);
        margin-bottom: var(--space-4);
      }

      .fields-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        margin: 0;
      }

      .fields-table thead {
        background: var(--gray-50);
        position: sticky;
        top: 0;
        z-index: 10;
      }

      .fields-table th {
        padding: var(--space-3) var(--space-4);
        text-align: left;
        font-weight: 600;
        font-size: var(--text-sm);
        color: var(--gray-700);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border-bottom: 2px solid var(--gray-200);
      }

      .fields-table th:first-child {
        width: 40%;
      }

      .fields-table th:last-child {
        width: 60%;
      }

      .fields-table td {
        padding: var(--space-3) var(--space-4);
        border-bottom: 1px solid var(--gray-100);
        vertical-align: top;
      }

      .fields-table tbody tr:last-child td {
        border-bottom: none;
      }

      .fields-table tbody tr {
        transition: background-color 0.15s;
      }

      .fields-table tbody tr:hover {
        background: var(--gray-50);
      }

      .fields-table label {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        cursor: pointer;
        margin: 0;
      }

      .field-checkbox {
        width: 18px;
        height: 18px;
        cursor: pointer;
        accent-color: var(--primary-500);
      }

      .field-checkbox:disabled {
        cursor: not-allowed;
        opacity: 0.6;
      }

      .field-name {
        font-weight: 500;
        color: var(--gray-900);
        font-size: var(--text-sm);
      }

      .field-observation {
        font-size: var(--text-sm);
        color: var(--gray-600);
        line-height: 1.5;
      }

      .form-group {
        margin-bottom: var(--space-4);
      }

      .form-group label {
        display: block;
        font-weight: 500;
        color: var(--gray-700);
        margin-bottom: var(--space-2);
        font-size: var(--text-sm);
      }

      .form-group select {
        width: 100%;
        padding: var(--space-3) var(--space-4);
        border: 1px solid var(--gray-300);
        border-radius: var(--radius-md);
        font-size: var(--text-sm);
        background: white;
        color: var(--gray-900);
        transition: all 0.2s;
      }

      .form-group select:focus {
        outline: none;
        border-color: var(--primary-500);
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .form-group select:disabled {
        background: var(--gray-50);
        cursor: not-allowed;
        opacity: 0.6;
      }

      .file-input-container {
        display: flex;
        gap: var(--space-3);
        align-items: stretch;
      }

      .file-input {
        flex: 1;
        padding: var(--space-3) var(--space-4);
        border: 1px solid var(--gray-300);
        border-radius: var(--radius-md);
        font-size: var(--text-sm);
        background: white;
        transition: all 0.2s;
        cursor: pointer;
      }

      .file-input::file-selector-button {
        padding: var(--space-2) var(--space-3);
        margin-right: var(--space-3);
        border: none;
        border-radius: var(--radius-sm);
        background: var(--gray-100);
        color: var(--gray-700);
        font-size: var(--text-xs);
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s;
      }

      .file-input::file-selector-button:hover {
        background: var(--gray-200);
      }

      .file-input:focus {
        outline: none;
        border-color: var(--primary-500);
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .browse-btn {
        background: var(--gray-600);
        color: white;
        border: none;
        padding: var(--space-3) var(--space-4);
        border-radius: var(--radius-md);
        cursor: pointer;
        font-weight: 500;
        font-size: var(--text-sm);
        transition: all 0.2s;
        white-space: nowrap;
      }

      .browse-btn:hover {
        background: var(--gray-700);
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .import-btn {
        width: 100%;
        background: linear-gradient(135deg, var(--emerald-500), var(--emerald-600));
        color: white;
        border: none;
        padding: var(--space-4) var(--space-5);
        border-radius: var(--radius-md);
        cursor: pointer;
        font-weight: 600;
        font-size: var(--text-base);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        transition: all 0.2s;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        margin-top: var(--space-4);
        min-height: 48px;
      }

      .import-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }

      .import-btn:active {
        transform: translateY(0);
      }

      .import-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      /* Responsivo */
      @media (max-width: 1024px) {
        .import-steps {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .download-options {
          flex-direction: column;
        }

        .download-template-btn {
          width: 100%;
        }

        .file-input-container {
          flex-direction: column;
        }

        .browse-btn {
          width: 100%;
        }

        .fields-table {
          font-size: var(--text-xs);
        }

        .fields-table th,
        .fields-table td {
          padding: var(--space-2) var(--space-3);
        }
      }
    </style>
  </head>
  <body data-page="configuracoes">
    <header>
      <div class="header-left">
        <div class="header-logo">
          <span>OS</span>
        </div>
        <div class="header-brand">
          <h1><i class="ti ti-settings"></i> Configura√ß√µes</h1>
          <p>Gerencie importa√ß√µes, configura√ß√µes e prefer√™ncias do sistema.</p>
        </div>
      </div>
      <div class="header-right">
        <div class="header-actions">
          <div class="header-user">
            <div class="user-avatar">A</div>
            <div class="user-info">
              <div class="user-name">Admin</div>
              <div class="user-role">Administrador</div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <nav>
      <div class="nav-inner">
        <a href="index.html" data-page="home">In√≠cio</a>
        <a href="clientes.html" data-page="clientes">Clientes</a>
        <a href="orcamentos.html" data-page="orcamentos">Or√ßamentos</a>
        <a href="pedidos.html" data-page="pedidos">Pedidos</a>
        <a href="produtos.html" data-page="produtos">Produtos</a>
        <a href="industrias.html" data-page="industrias">Ind√∫strias</a>
        <a href="crm.html" data-page="crm">CRM</a>
        <a href="configuracoes.html" data-page="configuracoes" class="is-active"
          ><i class="ti ti-settings"></i> Mais</a
        >
      </div>
    </nav>

    <main>
      <div class="config-container">
        <!-- Menu Lateral -->
        <aside class="config-sidebar">
          <h3>Importa√ß√µes</h3>
          <ul class="config-menu">
            <li class="config-menu-item">
              <a href="#importar-contatos" class="config-menu-link" data-section="importar-contatos">
                <i class="ti ti-address-book"></i> Importar Contatos
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-industrias" class="config-menu-link" data-section="importar-industrias">
                <i class="ti ti-building-factory"></i> Importar Ind√∫strias
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-produtos" class="config-menu-link" data-section="importar-produtos">
                <i class="ti ti-package"></i> Importar Produtos
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-faturamento" class="config-menu-link" data-section="importar-faturamento">
                <i class="ti ti-currency-dollar"></i> Importar Faturamento
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-fotos" class="config-menu-link" data-section="importar-fotos">
                <i class="ti ti-photo"></i> Importar Fotos
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-formas-pagamento" class="config-menu-link" data-section="importar-formas-pagamento">
                <i class="ti ti-credit-card"></i> Importar Formas de Pagamento
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-transportadoras" class="config-menu-link" data-section="importar-transportadoras">
                <i class="ti ti-truck"></i> Importar Transportadoras
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-pedido-rapido" class="config-menu-link" data-section="importar-pedido-rapido">
                <i class="ti ti-bolt"></i> Importar Pedido R√°pido
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#importar-grupo-conta" class="config-menu-link" data-section="importar-grupo-conta">
                <i class="ti ti-users"></i> Importar Grupo de Conta
              </a>
            </li>
          </ul>

          <h3 style="margin-top: var(--space-6);">Ferramentas</h3>
          <ul class="config-menu">
            <li class="config-menu-item">
              <a href="#criador-pedido" class="config-menu-link" data-section="criador-pedido">
                <i class="ti ti-clipboard-list"></i> Criador de Pedido
              </a>
            </li>
          </ul>

          <h3 style="margin-top: var(--space-6);">Configura√ß√µes</h3>
          <ul class="config-menu">
            <li class="config-menu-item">
              <a href="dados-cadastrais.html" class="config-menu-link">
                <i class="ti ti-file-text"></i> Dados Cadastrais
              </a>
            </li>
            <li class="config-menu-item">
              <a href="configuracao-sistema.html" class="config-menu-link">
                <i class="ti ti-settings"></i> Configura√ß√£o do Sistema
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#alterar-senha" class="config-menu-link" data-section="alterar-senha">
                <i class="ti ti-lock"></i> Alterar Senha
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#configurar-financeiro" class="config-menu-link" data-section="configurar-financeiro">
                <i class="ti ti-wallet"></i> Configurar Financeiro
              </a>
            </li>
            <li class="config-menu-item">
              <a href="#personalizar-campos" class="config-menu-link" data-section="personalizar-campos">
                <i class="ti ti-palette"></i> Personalizar Campos
              </a>
            </li>
          </ul>
        </aside>

        <!-- Conte√∫do -->
        <div class="config-content">
          <!-- Importar Contatos -->
          <section id="importar-contatos" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-address-book"></i> Importar Contatos</h2>
              <p>Importe contatos de clientes atrav√©s de arquivo Excel. O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.</p>
            </div>
            <div id="importar-contatos-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare sua planilha Excel
                  </h2>
                  <p class="step-description">
                    O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.
                    Selecione apenas os campos que voc√™ precisa:
                  </p>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelContatos"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                      <thead>
                        <tr>
                          <th>Coluna no Excel</th>
                          <th>Observa√ß√£o</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxCodigoCliente" />
                              <span class="field-name">C√≥digo do Cliente ou CNPJ/CPF</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Identificador do cliente ou documento (CNPJ/CPF) vinculado a este contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxNomeContato" checked />
                              <span class="field-name">Nome</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome completo do contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">E-mail</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Endere√ßo de e-mail principal do contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Departamento</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Setor ou departamento do contato. Ser√° cadastrado automaticamente se n√£o existir
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Cargo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Fun√ß√£o ou posi√ß√£o ocupada pelo contato na empresa
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Celular</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero de telefone celular do contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Telefone Fixo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero de telefone residencial ou comercial do contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">WhatsApp</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do WhatsApp. Formato: (62) 99999-9999
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Nextel</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do Nextel, caso o contato possua
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Data Anivers√°rio</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data de anivers√°rio do contato (apenas dia e m√™s). Exemplo: 19/11
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Observa√ß√µes</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Informa√ß√µes adicionais sobre o contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Comprador</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Indique "Sim" ou "N√£o" se o contato possui permiss√£o para realizar compras
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Telegram</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome de usu√°rio do Telegram do contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">E-mail Secund√°rio</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Endere√ßo de e-mail alternativo para comunica√ß√£o
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Telefone Secund√°rio</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero de telefone alternativo para contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Twitter</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome de usu√°rio do Twitter do contato
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelContatosBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Fa√ßa o upload do arquivo
                  </h2>
                  <p class="step-description">
                    Ap√≥s preencher a planilha conforme o modelo, selecione o arquivo e envie para importar os dados:
                  </p>
                  <form id="importFormContatos">
                    <div class="form-group">
                      <label for="arquivoInputContatos"
                        >Selecione o arquivo Excel com os contatos:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputContatos"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputContatos').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>
                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Contatos
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Faturamento -->
          <section id="importar-faturamento" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-currency-dollar"></i> Importar Faturamento</h2>
              <p>Importe parcelas de faturamento atrav√©s de arquivo Excel. O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.</p>
            </div>
            <div id="importar-faturamento-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare sua planilha Excel
                  </h2>
                  <p class="step-description">
                    O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.
                    Selecione apenas os campos que voc√™ precisa:
                  </p>

                  <!-- Se√ß√£o Importante -->
                  <div style="background: #f3f4f6; border-left: 4px solid #ef4444; padding: var(--space-4); margin-bottom: var(--space-4); border-radius: var(--radius-md);">
                    <h3 style="font-size: var(--text-sm); font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-2);"><i class="ti ti-alert-triangle"></i> Informa√ß√µes Importantes</h3>
                    <ul style="margin: 0; padding-left: var(--space-5); color: var(--gray-700); font-size: var(--text-sm); line-height: 1.6;">
                      <li>O processo de importa√ß√£o n√£o pode ser desfeito ap√≥s a conclus√£o;</li>
                      <li>O usu√°rio √© respons√°vel pela verifica√ß√£o e precis√£o dos dados inseridos na planilha;</li>
                      <li>Revise cuidadosamente todas as informa√ß√µes das parcelas antes de iniciar a importa√ß√£o;</li>
                      <li>O sistema n√£o assume responsabilidade por dados cadastrados incorretamente;</li>
                      <li>Parcelas sem identifica√ß√£o de pedido criar√£o novos pedidos automaticamente;</li>
                      <li>Pedidos gerados pela importa√ß√£o n√£o podem ser desbloqueados e ter√£o o tipo: Faturamento;</li>
                      <li>O limite m√°ximo √© de 500 parcelas por arquivo.</li>
                    </ul>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelFaturamento"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                      <thead>
                        <tr>
                          <th>Coluna no Excel</th>
                          <th>Observa√ß√£o</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Cliente - CNPJ/CPF</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ ou CPF do cliente. Necess√°rio apenas quando a venda √© identificada pelo n√∫mero na Ind√∫stria/Representada ou pela Ordem de Compra
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Ind√∫stria - CNPJ</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ da Ind√∫stria ou Representada. Necess√°rio apenas quando a venda √© identificada pelo n√∫mero na Ind√∫stria/Representada ou pela Ordem de Compra
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxNotaFiscal" checked />
                              <span class="field-name">Nota Fiscal</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero da nota fiscal
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxDataFatura" checked />
                              <span class="field-name">Data de Fatura</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data de faturamento da parcela
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxDataLiquidez" checked />
                              <span class="field-name">Data de Liquidez</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data de liquida√ß√£o das parcelas
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxValorParcela" checked />
                              <span class="field-name">Valor da Parcela</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Valor faturado da parcela
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxValorComissao" checked />
                              <span class="field-name">Valor da Comiss√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Valor da comiss√£o de cada parcela
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Comiss√£o do Pedido</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Percentual de comiss√£o para o pedido. Se n√£o informado, ser√° considerado 0
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Base de C√°lculo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Base de c√°lculo utilizada no pedido. Informe uma das op√ß√µes dispon√≠veis. Exemplo: 1 - Valor do Pedido - Desconto, informe: 1
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Ordem de Compra</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero da ordem de compra do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Pedido na Ind√∫stria</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do pedido na Ind√∫stria ou Representada
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Pedido no OurSales</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do pedido no sistema OurSales
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Data Recebimento da Comiss√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data de recebimento da comiss√£o da parcela. Se n√£o informado, ser√° utilizada a data atual
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">E-mail do Vendedor</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            E-mail para vincular o vendedor ao pedido. Aplica-se apenas a pedidos gerados pelo importador
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelFaturamentoBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Fa√ßa o upload do arquivo
                  </h2>
                  <p class="step-description">
                    Ap√≥s preencher a planilha conforme o modelo, selecione o arquivo e envie para importar os dados:
                  </p>
                  <form id="importFormFaturamento">
                    <div class="form-group">
                      <label for="arquivoInputFaturamento"
                        >Selecione o arquivo Excel com as parcelas de faturamento:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputFaturamento"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputFaturamento').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>
                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Faturamento
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Fotos -->
          <section id="importar-fotos" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-photo"></i> Importar Fotos</h2>
              <p>Importe fotos de produtos em lote atrav√©s de arquivo ZIP. O sistema permite vincular fotos aos produtos atrav√©s de c√≥digos.</p>
            </div>
            <div id="importar-fotos-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare as fotos para envio
                  </h2>
                  <p class="step-description">
                    Siga as instru√ß√µes abaixo para preparar corretamente as fotos antes do envio:
                  </p>

                  <div style="background: #f3f4f6; border-left: 4px solid #3b82f6; padding: var(--space-4); margin-bottom: var(--space-4); border-radius: var(--radius-md);">
                    <h3 style="font-size: var(--text-sm); font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-2);"><i class="ti ti-info-circle"></i> Instru√ß√µes de Prepara√ß√£o</h3>
                    <ul style="margin: 0; padding-left: var(--space-5); color: var(--gray-700); font-size: var(--text-sm); line-height: 1.6;">
                      <li><strong>Nomenclatura dos arquivos:</strong> As fotos podem ser identificadas pelo C√≥digo do Produto (SKU), EAN (C√≥digo de Barras), C√≥digo Original, Refer√™ncia ou Refer√™ncia de Agrupamento.</li>
                      <li><strong>Exemplo:</strong> Se importar pelo SKU do produto, um produto com c√≥digo "10012BR" deve ter uma imagem nomeada "10012BR.jpg" ou ".png".</li>
                      <li><strong>Consist√™ncia:</strong> Para garantir o sucesso do upload, utilize o mesmo c√≥digo de vincula√ß√£o para todos os itens do arquivo. Para fotos vinculadas por EAN, use o EAN como nome do arquivo.</li>
                      <li><strong>M√∫ltiplas fotos:</strong> √â poss√≠vel enviar at√© 6 fotos por produto. Use "#" seguido de um n√∫mero no nome da imagem (exemplo: "10012-45-BR#1.jpg" e "10012-45-BR#2.jpg").</li>
                      <li><strong>Ordem das fotos:</strong> O n√∫mero ap√≥s "#" determina a ordem da foto no cadastro do produto, come√ßando da √∫ltima foto inserida.</li>
                      <li><strong>Aplica√ß√£o:</strong> As fotos ser√£o aplicadas a todos os produtos da mesma ind√∫stria com c√≥digos id√™nticos, mesmo em tabelas de pre√ßos diferentes.</li>
                      <li><strong>Formato:</strong> As fotos devem estar nos formatos JPG ou PNG.</li>
                      <li><strong>Tamanho m√°ximo:</strong> O tamanho m√°ximo do arquivo compactado (ZIP) contendo todas as fotos √© <strong>200 MB</strong>.</li>
                      <li><strong>Redu√ß√£o de tamanho:</strong> Evite fotos muito grandes; utilize programas de edi√ß√£o de imagem para reduzir o tamanho.</li>
                      <li><strong>Quantidade:</strong> Um arquivo compactado pode conter dezenas de fotos, dependendo do tamanho de cada foto.</li>
                    </ul>
                  </div>

                  <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: var(--space-4); margin-bottom: var(--space-4); border-radius: var(--radius-md);">
                    <p style="margin: 0; color: var(--gray-700); font-size: var(--text-sm); line-height: 1.6;">
                      <strong><i class="ti ti-bulb"></i> Dica importante:</strong> Quando uma foto tiver o mesmo c√≥digo do item, a foto ser√° vinculada automaticamente ao produto correspondente.
                    </p>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Envie o arquivo compactado (ZIP)
                  </h2>
                  <p class="step-description">
                    Ap√≥s preparar as fotos conforme as instru√ß√µes, selecione a ind√∫stria, o c√≥digo de mapeamento e envie o arquivo ZIP:
                  </p>
                  <form id="importFormFotos">
                    <div class="form-group">
                      <label for="industriaSelectFotos">Escolha a Ind√∫stria:</label>
                      <select id="industriaSelectFotos" class="form-group select" required>
                        <option value="">Selecione uma ind√∫stria</option>
                      </select>
                    </div>

                    <div class="form-group">
                      <label for="codigoSelectFotos">Selecione o c√≥digo para importa√ß√£o:</label>
                      <select id="codigoSelectFotos" class="form-group select" required>
                        <option value="">Selecione o c√≥digo</option>
                        <option value="sku">C√≥digo do Produto (SKU)</option>
                        <option value="ean">EAN (C√≥digo de Barras)</option>
                        <option value="codigoOriginal">C√≥digo Original</option>
                        <option value="referencia">Refer√™ncia</option>
                        <option value="referenciaAgrupamento">Refer√™ncia de Agrupamento</option>
                      </select>
                      <small style="display: block; margin-top: var(--space-1); color: var(--gray-600); font-size: var(--text-xs);">
                        Dica: Escolha qual c√≥digo ser√° mapeado para o nome do arquivo da foto.
                      </small>
                    </div>

                    <div class="form-group">
                      <label for="acaoSelectFotos">O que fazer?</label>
                      <select id="acaoSelectFotos" class="form-group select" required>
                        <option value="adicionar">Adicionar novas fotos</option>
                        <option value="substituir">Substituir fotos existentes nos produtos</option>
                      </select>
                    </div>

                    <div class="form-group">
                      <label for="arquivoInputFotos">Selecione o arquivo ZIP com as fotos:</label>
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputFotos"
                          class="file-input"
                          accept=".zip"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputFotos').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                      <small style="display: block; margin-top: var(--space-1); color: var(--gray-600); font-size: var(--text-xs);">
                        Tamanho m√°ximo do arquivo: 200MB
                      </small>
                    </div>

                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Enviar Arquivo
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Formas de Pagamento -->
          <section id="importar-formas-pagamento" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-credit-card"></i> Importar Formas de Pagamento</h2>
              <p>Importe formas de pagamento atrav√©s de arquivo Excel. O sistema permite configurar condi√ß√µes de pagamento para ind√∫strias.</p>
            </div>
            <div id="importar-formas-pagamento-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Fa√ßa o download do modelo
                  </h2>
                  <p class="step-description">
                    Clique no bot√£o abaixo e fa√ßa o download da planilha de formas de pagamento para importa√ß√£o:
                  </p>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelFormasPagamento"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                      <thead>
                        <tr>
                          <th>Coluna no Excel</th>
                          <th>Observa√ß√£o</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxCNPJFormasPagamento" checked />
                              <span class="field-name">CNPJ</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ da Ind√∫stria ou Representada
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxDescricaoFormasPagamento" checked />
                              <span class="field-name">Descri√ß√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Exemplo: √Ä Vista, 30/60/90
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxQuantidadeParcelas" checked />
                              <span class="field-name">Quantidade de Parcelas</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Quantidade de parcelas que ser√° gerada pela forma de pagamento
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxIntervaloDias" checked />
                              <span class="field-name">Intervalo de dias</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Intervalo de dias entre cada parcela
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Desconto</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Percentual de desconto aplicado por utilizar esta forma de pagamento
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Pedido M√≠nimo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Valor m√≠nimo do pedido para que esta forma de pagamento possa ser utilizada
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelFormasPagamentoBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Envie sua planilha
                  </h2>
                  <p class="step-description">
                    J√° preencheu a planilha de acordo com o modelo? Ent√£o agora √© hora de envi√°-la para o sistema:
                  </p>
                  <form id="importFormFormasPagamento">
                    <div class="form-group">
                      <label for="arquivoInputFormasPagamento"
                        >Localize a planilha de formas de pagamento em seu computador:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputFormasPagamento"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputFormasPagamento').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>
                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Formas de Pagamento
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Transportadoras -->
          <section id="importar-transportadoras" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-truck"></i> Importar Transportadoras</h2>
              <p>Importe transportadoras atrav√©s de arquivo Excel. O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.</p>
            </div>
            <div id="importar-transportadoras-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare sua planilha Excel
                  </h2>
                  <p class="step-description">
                    O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.
                    Selecione apenas os campos que voc√™ precisa:
                  </p>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelTransportadoras"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                      <thead>
                        <tr>
                          <th>Coluna no Excel</th>
                          <th>Observa√ß√£o</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxRazaoSocialTransportadora" checked />
                              <span class="field-name">Raz√£o Social</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Raz√£o social da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxNomeFantasiaTransportadora" checked />
                              <span class="field-name">Nome Fantasia</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome fantasia da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxCNPJTransportadora" checked />
                              <span class="field-name">CNPJ</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxInscricaoEstadualTransportadora" checked />
                              <span class="field-name">Inscri√ß√£o Estadual</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Inscri√ß√£o estadual da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Inscri√ß√£o Municipal</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Inscri√ß√£o municipal da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxEnderecoTransportadora" checked />
                              <span class="field-name">Endere√ßo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Endere√ßo da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Complemento</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Informa√ß√£o complementar para o endere√ßo da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxBairroTransportadora" checked />
                              <span class="field-name">Bairro</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Exemplo: Centro
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxCEPTransportadora" checked />
                              <span class="field-name">CEP</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CEP do endere√ßo da transportadora. Exemplo: 75400-000
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxNumeroTransportadora" checked />
                              <span class="field-name">N√∫mero</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do endere√ßo da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxCidadeTransportadora" checked />
                              <span class="field-name">Cidade</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Exemplo: Inhumas
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxEstadoTransportadora" checked />
                              <span class="field-name">Estado</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Apenas siglas. Exemplo: GO ou DF
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxTelefoneTransportadora" checked />
                              <span class="field-name">Telefone</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do telefone para contato. Exemplo: (62) 3514-5144
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Telefone/Fax</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do fax da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">E-mail</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            E-mail da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Website</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Exemplo: www.correios.com.br - www.granero.com.br
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Contato</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Contato da transportadora no formato Nome:E-mail:Telefone. Exemplo: Jos√© J√∫nior:josejunior@oursales.com:(62) 3514-5144
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Anivers√°rio</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data de anivers√°rio do contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Observa√ß√µes</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Observa√ß√µes sobre a transportadora
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelTransportadorasBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Fa√ßa o upload do arquivo
                  </h2>
                  <p class="step-description">
                    Ap√≥s preencher a planilha conforme o modelo, selecione o arquivo e envie para importar os dados:
                  </p>
                  <form id="importFormTransportadoras">
                    <div class="form-group">
                      <label for="arquivoInputTransportadoras"
                        >Localize a tabela de transportadora em seu computador:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputTransportadoras"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputTransportadoras').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>
                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Transportadoras
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Pedido R√°pido -->
          <section id="importar-pedido-rapido" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-bolt"></i> Importar Pedido R√°pido</h2>
              <p>Importe pedidos atrav√©s de arquivo Excel. O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.</p>
            </div>
            <div id="importar-pedido-rapido-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare sua planilha Excel
                  </h2>
                  <p class="step-description">
                    O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.
                    Selecione apenas os campos que voc√™ precisa:
                  </p>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelPedidoRapido"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                      <thead>
                        <tr>
                          <th>Coluna no Excel</th>
                          <th>Observa√ß√£o</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Cliente - CNPJ/CPF</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ ou CPF do cliente do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Cliente - C√≥digo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            C√≥digo do cliente no sistema
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Cliente - Raz√£o Social</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Raz√£o social do cliente para inclus√£o
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Cliente - Nome Fantasia</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome fantasia do cliente
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Cliente - E-mail</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            E-mail do cliente
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Ind√∫stria - CNPJ</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ da ind√∫stria ou representada
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Ind√∫stria - Raz√£o Social</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Raz√£o social da representada ou ind√∫stria do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Ind√∫stria - Nome Fantasia</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome fantasia da ind√∫stria
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Vendedor - Nome</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome do vendedor respons√°vel pelo pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Vendedor - E-mail</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            E-mail do vendedor deste pedido. Deve estar cadastrado no sistema
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Valor</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Valor total do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Data Venda</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data de venda do pedido no formato dd/MM/aaaa
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">N√∫mero na Ind√∫stria</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do pedido na ind√∫stria ou representada
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Ordem de Compra</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero da ordem de compra
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Quantidade de Itens</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Quantidade total de itens no pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Condi√ß√£o de Pagamento</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Condi√ß√£o de pagamento do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Data de Fatura</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data de faturamento do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Data de Entrega</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Data prevista para entrega do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Endere√ßo de Cobran√ßa</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Endere√ßo para cobran√ßa do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Endere√ßo de Entrega</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Endere√ßo para entrega do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">N√∫mero do Tal√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero do tal√£o do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Frete</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Tipo de frete do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Valor do Frete</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Valor do frete do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Transportadora - CNPJ</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ da transportadora respons√°vel pela entrega
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Transportadora - Raz√£o Social</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Raz√£o social da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Transportadora - Nome Fantasia</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome fantasia da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Transportadora - E-mail</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            E-mail da transportadora
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Comprador - Nome</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome do comprador respons√°vel pelo pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Comprador - E-mail</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            E-mail do comprador
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Comiss√£o %</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Percentual de comiss√£o do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Tipo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Tipo do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Nota Fiscal</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero da nota fiscal do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Status do Pedido</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Status atual do pedido
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Observa√ß√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Observa√ß√µes adicionais sobre o pedido
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelPedidoRapidoBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Fa√ßa o upload do arquivo
                  </h2>
                  <p class="step-description">
                    Ap√≥s preencher a planilha conforme o modelo, selecione o arquivo e envie para importar os dados:
                  </p>
                  <form id="importFormPedidoRapido">
                    <div class="form-group">
                      <label for="arquivoInputPedidoRapido"
                        >Localize a tabela de pedido em seu computador:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputPedidoRapido"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputPedidoRapido').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>
                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Pedidos
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Grupo de Conta -->
          <section id="importar-grupo-conta" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-currency-dollar"></i> Importar Grupo de Conta</h2>
              <p>Importe grupos de contas financeiras atrav√©s de arquivo Excel. O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.</p>
            </div>
            <div id="importar-grupo-conta-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare sua planilha Excel
                  </h2>
                  <p class="step-description">
                    O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.
                    Selecione apenas os campos que voc√™ precisa:
                  </p>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelGrupoConta"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                      <thead>
                        <tr>
                          <th>Coluna no Excel</th>
                          <th>Observa√ß√£o</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">C√≥digo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            C√≥digo de identifica√ß√£o do grupo de contas. Necess√°rio para atualiza√ß√µes
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Descri√ß√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Descri√ß√£o do grupo de contas
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Tipo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Tipo do grupo de conta: Receita ou Despesa
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">C√≥digo de Classifica√ß√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            C√≥digo de classifica√ß√£o do grupo de contas
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">C√≥digo do Grupo Principal</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            C√≥digo do grupo de contas que ser√° usado como grupo principal
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelGrupoContaBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Fa√ßa o upload do arquivo
                  </h2>
                  <p class="step-description">
                    Ap√≥s preencher a planilha conforme o modelo, selecione o arquivo e envie para importar os dados:
                  </p>
                  <form id="importFormGrupoConta">
                    <div class="form-group">
                      <label for="arquivoInputGrupoConta"
                        >Localize o arquivo em seu computador:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputGrupoConta"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputGrupoConta').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>
                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Grupo de Conta
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Ind√∫strias -->
          <section id="importar-industrias" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-building-factory"></i> Importar Ind√∫strias</h2>
              <p>Importe ind√∫strias e fornecedores atrav√©s de arquivo Excel. O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.</p>
            </div>
            <div id="importar-industrias-content">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare sua planilha Excel
                  </h2>
                  <p class="step-description">
                    O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.
                    Selecione apenas os campos que voc√™ precisa:
                  </p>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelIndustrias"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                      <thead>
                        <tr>
                          <th>Coluna no Excel</th>
                          <th>Observa√ß√£o</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxRazaoSocial" checked />
                              <span class="field-name">Raz√£o Social</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome oficial da empresa conforme registro
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Nome Fantasia</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Nome comercial utilizado pela empresa
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" id="checkboxCNPJ" checked />
                              <span class="field-name">CNPJ</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            CNPJ da empresa com ou sem formata√ß√£o
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Inscri√ß√£o Estadual</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Inscri√ß√£o estadual da empresa junto √† Receita Estadual
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">E-mail</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            E-mail de contato que receber√° os pedidos e comunica√ß√µes
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Comiss√£o</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Percentual de comiss√£o. Exemplos: 10, 5, 4.5 (sem o s√≠mbolo %)
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Endere√ßo</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Logradouro completo da empresa
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Bairro</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Bairro onde a empresa est√° localizada
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">CEP</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            C√≥digo postal com ou sem formata√ß√£o
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Cidade</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Munic√≠pio de localiza√ß√£o da empresa
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Estado</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Sigla do estado (UF) com 2 letras. Ex: SP, RJ, MG
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Telefone</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Telefone principal para contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Telefone Adicional</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Telefone secund√°rio ou alternativo para contato
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Fax</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            N√∫mero de fax da empresa (se houver)
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" />
                              <span class="field-name">Website</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Site oficial da empresa na internet
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <label>
                              <input type="checkbox" class="field-checkbox" checked />
                              <span class="field-name">Observa√ß√µes</span>
                            </label>
                          </td>
                          <td class="field-observation">
                            Notas e informa√ß√µes complementares sobre a empresa. Apenas voc√™ visualiza estas informa√ß√µes
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelIndustriasBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Fa√ßa o upload do arquivo
                  </h2>
                  <p class="step-description">
                    Ap√≥s preencher a planilha conforme o modelo, selecione o arquivo e envie para importar os dados:
                  </p>

                  <form id="importFormIndustrias">
                    <div class="form-group">
                      <label for="arquivoInputIndustrias"
                        >Selecione o arquivo Excel com as ind√∫strias:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInputIndustrias"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInputIndustrias').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>

                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Ind√∫strias
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Produtos -->
          <section id="importar-produtos" class="config-section active">
            <div class="config-section-header">
              <h2><i class="ti ti-package"></i> Importar Produtos</h2>
              <p>Importe produtos atrav√©s de arquivo Excel, CSV ou TXT. A importa√ß√£o √© personalizada e voc√™ pode usar v√°rios campos ou apenas alguns que julgar necess√°rio.</p>
            </div>
            <div id="importar-produtos-content" class="import-container">
              <div class="import-steps">
                <!-- 1¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">1</span>
                    Primeiro Passo - Prepare sua planilha Excel
                  </h2>
                  <p class="step-description">
                    O sistema permite escolher quais informa√ß√µes deseja incluir na importa√ß√£o.
                    Selecione apenas os campos que voc√™ precisa:
                  </p>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcel"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>

                  <div class="fields-table-wrapper">
                    <table class="fields-table">
                    <thead>
                      <tr>
                        <th>Coluna no Excel</th>
                        <th>Observa√ß√£o</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" id="checkboxCodigo" checked disabled />
                            <span class="field-name">C√≥digo</span>
                          </label>
                        </td>
                        <td class="field-observation">
                          Campo obrigat√≥rio. Aceita letras, n√∫meros e caracteres especiais
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">Nome do produto</span>
                          </label>
                        </td>
                        <td class="field-observation">Necess√°rio ao cadastrar novos itens no sistema.</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" checked />
                            <span class="field-name">Pre√ßo</span>
                          </label>
                        </td>
                        <td class="field-observation">
                          Caso n√£o seja informado, o valor padr√£o ser√° R$ 0,00
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" checked />
                            <span class="field-name">Unidade</span>
                          </label>
                        </td>
                        <td class="field-observation">Exemplos: UN, UNID, PCT, CX, FARDO, KG, L</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" checked />
                            <span class="field-name">Embalagem</span>
                          </label>
                        </td>
                        <td class="field-observation">Tipo de embalagem utilizada para o item</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">Fator de Embalagem</span>
                          </label>
                        </td>
                        <td class="field-observation">
                          Multiplicador usado para converter pre√ßo da embalagem em pre√ßo unit√°rio
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">Data de Lan√ßamento</span>
                          </label>
                        </td>
                        <td class="field-observation">Data em que o item foi disponibilizado no mercado</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" checked />
                            <span class="field-name">IPI</span>
                          </label>
                        </td>
                        <td class="field-observation">Valor padr√£o ser√° 0% caso n√£o seja informado</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">ICMS %</span>
                          </label>
                        </td>
                        <td class="field-observation">Percentual de ICMS aplicado ao produto</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">CEST</span>
                          </label>
                        </td>
                        <td class="field-observation">C√≥digo CEST para classifica√ß√£o fiscal</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">CFOP</span>
                          </label>
                        </td>
                        <td class="field-observation">
                          C√≥digo CFOP padr√£o utilizado na emiss√£o de notas fiscais
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" checked />
                            <span class="field-name">Observa√ß√µes</span>
                          </label>
                        </td>
                        <td class="field-observation">
                          Notas e informa√ß√µes complementares sobre o item
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" checked />
                            <span class="field-name">Comiss√£o por produto</span>
                          </label>
                        </td>
                        <td class="field-observation">
                          Utilize apenas se a comiss√£o for calculada por produto. Ignore se for por pedido
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">C√≥digo de barras</span>
                          </label>
                        </td>
                        <td class="field-observation">C√≥digo de barras padr√£o GTIN/EAN</td>
                      </tr>
                      <tr>
                        <td>
                          <label>
                            <input type="checkbox" class="field-checkbox" />
                            <span class="field-name">ST-UF</span>
                          </label>
                        </td>
                        <td class="field-observation">
                          Substitui√ß√£o Tribut√°ria por estado. Informe no formato ST-XX onde XX √© a sigla do estado. Exemplos: ST-RJ, ST-SP, ST-MG
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  </div>

                  <div class="download-options">
                    <button
                      type="button"
                      class="download-template-btn"
                      id="downloadTemplateExcelBottom"
                    >
                      <i class="ti ti-download"></i> Download do meu modelo de planilha
                    </button>
                  </div>
                </div>

                <!-- 2¬∫ Passo -->
                <div class="step-card">
                  <h2 class="step-title">
                    <span class="step-number">2</span>
                    Segundo Passo - Fa√ßa o upload do arquivo
                  </h2>
                  <p class="step-description">
                    Ap√≥s preencher a planilha conforme o modelo, selecione o arquivo e envie para importar os dados:
                  </p>

                  <form id="importForm">
                    <div class="form-group">
                      <label for="industriaSelect"
                        >Selecione a Ind√∫stria ou Fornecedor:</label
                      >
                      <select id="industriaSelect" required>
                        <option value="">Selecione...</option>
                      </select>
                    </div>

                    <div class="form-group">
                      <label for="tabelaPrecoSelect"
                        >Selecione a Tabela de Pre√ßos:</label
                      >
                      <select id="tabelaPrecoSelect" required disabled>
                        <option value="">Selecione...</option>
                      </select>
                    </div>

                    <div class="form-group">
                      <label for="arquivoInput"
                        >Selecione o arquivo Excel com os produtos:</label
                      >
                      <div class="file-input-container">
                        <input
                          type="file"
                          id="arquivoInput"
                          class="file-input"
                          accept=".xlsx,.xls"
                          required
                        />
                        <button
                          type="button"
                          class="browse-btn"
                          onclick="document.getElementById('arquivoInput').click()"
                        >
                          <i class="ti ti-folder"></i> Selecionar Arquivo
                        </button>
                      </div>
                    </div>

                    <button type="submit" class="import-btn">
                      <i class="ti ti-upload"></i> Importar Produtos
                    </button>
                  </form>
                </div>
              </div>
            </div>
          </section>

          <!-- Importar Faturamento -->
          <section id="importar-faturamento" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-currency-dollar"></i> Importar Faturamento</h2>
              <p>Importe dados de faturamento atrav√©s de arquivo Excel, CSV ou TXT.</p>
            </div>
            <div class="empty-state">
              <p>Funcionalidade em desenvolvimento.</p>
            </div>
          </section>

          <!-- Importar Fotos -->
          <section id="importar-fotos" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-photo"></i> Importar Fotos</h2>
              <p>Importe fotos de produtos atrav√©s de arquivos de imagem ou ZIP.</p>
            </div>
            <div class="empty-state">
              <p>Funcionalidade em desenvolvimento.</p>
            </div>
          </section>

          <!-- Importar Formas de Pagamento -->
          <section id="importar-formas-pagamento" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-credit-card"></i> Importar Formas de Pagamento</h2>
              <p>Importe formas de pagamento atrav√©s de arquivo Excel, CSV ou TXT.</p>
            </div>
            <div class="empty-state">
              <p>Funcionalidade em desenvolvimento.</p>
            </div>
          </section>

          <!-- Importar Transportadoras -->
          <section id="importar-transportadoras" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-truck"></i> Importar Transportadoras</h2>
              <p>Importe transportadoras atrav√©s de arquivo Excel, CSV ou TXT.</p>
            </div>
            <div class="empty-state">
              <p>Funcionalidade em desenvolvimento.</p>
            </div>
          </section>

          <!-- Importar Pedido R√°pido -->
          <section id="importar-pedido-rapido" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-bolt"></i> Importar Pedido R√°pido</h2>
              <p>Importe pedidos r√°pidos atrav√©s de arquivo Excel, CSV ou TXT.</p>
            </div>
            <div class="empty-state">
              <p>Funcionalidade em desenvolvimento.</p>
            </div>
          </section>

          <!-- Importar Grupo de Conta -->
          <section id="importar-grupo-conta" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-users"></i> Importar Grupo de Conta</h2>
              <p>Importe grupos de conta atrav√©s de arquivo Excel, CSV ou TXT.</p>
            </div>
            <div class="empty-state">
              <p>Funcionalidade em desenvolvimento.</p>
            </div>
          </section>

          <!-- Criador de Pedido -->
          <section id="criador-pedido" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-clipboard-list"></i> Criador de Pedido</h2>
              <p>Ferramenta para criar pedidos de forma r√°pida e eficiente.</p>
            </div>
            <div class="empty-state">
              <p>Funcionalidade em desenvolvimento.</p>
            </div>
          </section>

          <!-- Dados Cadastrais -->
          <section id="dados-cadastrais" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-file-text"></i> Dados Cadastrais</h2>
              <p>Gerencie os dados cadastrais da empresa. Esta se√ß√£o √© acess√≠vel apenas pelo gerente do sistema.</p>
            </div>
            <div id="dados-cadastrais-content">
              <form id="formDadosCadastrais">
                <!-- Bot√µes de a√ß√£o no topo -->
                <div style="display: flex; gap: var(--space-3); margin-bottom: var(--space-6); align-items: center;">
                  <button type="submit" class="btn btn-primary" style="display: flex; align-items: center; gap: var(--space-2);">
                    <i class="ti ti-device-floppy"></i> Salvar
                  </button>
                  <a href="#" onclick="event.preventDefault(); window.location.reload();" style="color: var(--gray-600); text-decoration: none;">
                    ou Cancelar
                  </a>
                </div>

                <!-- Informa√ß√µes Principais -->
                <div style="margin-bottom: var(--space-6);">
                  <h3 style="font-size: var(--text-lg); font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-4); border-bottom: 2px solid var(--gray-200); padding-bottom: var(--space-2);">
                    Informa√ß√µes Principais
                  </h3>
                  
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4);">
                    <div class="form-group">
                      <label for="subdominio">
                        Seu Site no OurSales
                      </label>
                      <div style="display: flex; align-items: center; gap: var(--space-2);">
                        <input
                          type="text"
                          id="subdominio"
                          name="subdominio"
                          class="form-control"
                          placeholder="seu-subdominio"
                          pattern="[a-z0-9-]+"
                          style="flex: 1;"
                        />
                        <span style="color: var(--gray-600); font-weight: 500;">.oursales.com</span>
                      </div>
                      <small style="display: block; margin-top: var(--space-1); color: var(--gray-600); font-size: var(--text-xs);">
                        Escolha um subdom√≠nio personalizado. Ser√° verificado se est√° dispon√≠vel.
                      </small>
                      <div id="subdominioStatus" style="margin-top: var(--space-1); font-size: var(--text-xs);"></div>
                    </div>

                    <div class="form-group">
                      <label for="nomeFantasia">
                        Nome Fantasia <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="nomeFantasia"
                        name="nomeFantasia"
                        class="form-control"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="razaoSocial">
                        Raz√£o Social <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="razaoSocial"
                        name="razaoSocial"
                        class="form-control"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="cnpj">
                        CNPJ <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="cnpj"
                        name="cnpj"
                        class="form-control"
                        placeholder="00.000.000/0000-00"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="inscricaoEstadual">Inscri√ß√£o Estadual</label>
                      <input
                        type="text"
                        id="inscricaoEstadual"
                        name="inscricaoEstadual"
                        class="form-control"
                      />
                    </div>

                    <div class="form-group">
                      <label for="inscricaoMunicipal">Inscri√ß√£o Municipal</label>
                      <input
                        type="text"
                        id="inscricaoMunicipal"
                        name="inscricaoMunicipal"
                        class="form-control"
                      />
                    </div>
                  </div>
                </div>

                <!-- Endere√ßo -->
                <div style="margin-bottom: var(--space-6);">
                  <h3 style="font-size: var(--text-lg); font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-4); border-bottom: 2px solid var(--gray-200); padding-bottom: var(--space-2);">
                    Endere√ßo
                  </h3>
                  
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4);">
                    <div class="form-group" style="grid-column: 1 / -1;">
                      <label for="endereco">
                        Endere√ßo <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="endereco"
                        name="endereco"
                        class="form-control"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="numero">
                        N√∫mero <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="numero"
                        name="numero"
                        class="form-control"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="bairro">
                        Bairro <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="bairro"
                        name="bairro"
                        class="form-control"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="cep">
                        CEP <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="cep"
                        name="cep"
                        class="form-control"
                        placeholder="00000-000"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="cidade">
                        Cidade <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="text"
                        id="cidade"
                        name="cidade"
                        class="form-control"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="estado">
                        Estado <span style="color: #ef4444;">*</span>
                      </label>
                      <select
                        id="estado"
                        name="estado"
                        class="form-control"
                        required
                      >
                        <option value="">Selecione</option>
                        <option value="AC">AC - Acre</option>
                        <option value="AL">AL - Alagoas</option>
                        <option value="AP">AP - Amap√°</option>
                        <option value="AM">AM - Amazonas</option>
                        <option value="BA">BA - Bahia</option>
                        <option value="CE">CE - Cear√°</option>
                        <option value="DF">DF - Distrito Federal</option>
                        <option value="ES">ES - Esp√≠rito Santo</option>
                        <option value="GO">GO - Goi√°s</option>
                        <option value="MA">MA - Maranh√£o</option>
                        <option value="MT">MT - Mato Grosso</option>
                        <option value="MS">MS - Mato Grosso do Sul</option>
                        <option value="MG">MG - Minas Gerais</option>
                        <option value="PA">PA - Par√°</option>
                        <option value="PB">PB - Para√≠ba</option>
                        <option value="PR">PR - Paran√°</option>
                        <option value="PE">PE - Pernambuco</option>
                        <option value="PI">PI - Piau√≠</option>
                        <option value="RJ">RJ - Rio de Janeiro</option>
                        <option value="RN">RN - Rio Grande do Norte</option>
                        <option value="RS">RS - Rio Grande do Sul</option>
                        <option value="RO">RO - Rond√¥nia</option>
                        <option value="RR">RR - Roraima</option>
                        <option value="SC">SC - Santa Catarina</option>
                        <option value="SP">SP - S√£o Paulo</option>
                        <option value="SE">SE - Sergipe</option>
                        <option value="TO">TO - Tocantins</option>
                      </select>
                    </div>
                  </div>
                </div>

                <!-- Outras Informa√ß√µes -->
                <div style="margin-bottom: var(--space-6);">
                  <h3 style="font-size: var(--text-lg); font-weight: 600; color: var(--gray-900); margin-bottom: var(--space-4); border-bottom: 2px solid var(--gray-200); padding-bottom: var(--space-2);">
                    Outras Informa√ß√µes
                  </h3>
                  
                  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4);">
                    <div class="form-group" style="grid-column: 1 / -1;">
                      <label for="emailCobranca" style="display: flex; align-items: center; gap: var(--space-1);">
                        E-mail para Cobran√ßa e Notifica√ß√µes <span style="color: #ef4444;">*</span>
                        <span style="color: var(--gray-400); cursor: help;" title="E-mail utilizado para envio de notifica√ß√µes e cobran√ßas"><i class="ti ti-info-circle"></i></span>
                      </label>
                      <input
                        type="email"
                        id="emailCobranca"
                        name="emailCobranca"
                        class="form-control"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="website">Website</label>
                      <input
                        type="url"
                        id="website"
                        name="website"
                        class="form-control"
                        placeholder="https://www.exemplo.com.br"
                      />
                    </div>

                    <div class="form-group">
                      <label for="telefone">
                        Telefone <span style="color: #ef4444;">*</span>
                      </label>
                      <input
                        type="tel"
                        id="telefone"
                        name="telefone"
                        class="form-control"
                        placeholder="(00) 0000-0000"
                        required
                      />
                    </div>

                    <div class="form-group">
                      <label for="fax">FAX</label>
                      <input
                        type="tel"
                        id="fax"
                        name="fax"
                        class="form-control"
                        placeholder="(00) 0000-0000"
                      />
                    </div>
                  </div>
                </div>

                <!-- Bot√µes de a√ß√£o no rodap√© -->
                <div style="display: flex; gap: var(--space-3); margin-top: var(--space-6); padding-top: var(--space-6); border-top: 1px solid var(--gray-200); align-items: center;">
                  <button type="submit" class="btn btn-primary" style="display: flex; align-items: center; gap: var(--space-2);">
                    <i class="ti ti-device-floppy"></i> Salvar
                  </button>
                  <a href="#" onclick="event.preventDefault(); window.location.reload();" style="color: var(--gray-600); text-decoration: none;">
                    ou Cancelar
                  </a>
                </div>
              </form>
            </div>
          </section>

          <!-- Configura√ß√£o do Sistema -->
          <section id="configuracao-sistema" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-settings"></i> Configura√ß√£o do Sistema</h2>
              <p>Configure as prefer√™ncias gerais do sistema.</p>
            </div>
            <div class="empty-state" id="configuracao-sistema-content">
              <p>Esta se√ß√£o foi movida para uma p√°gina dedicada. <a href="configuracao-sistema.html">Clique aqui para acessar</a>.</p>
            </div>
          </section>

          <!-- Alterar Senha -->
          <section id="alterar-senha" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-lock"></i> Alterar Senha</h2>
              <p>√â recomend√°vel alterar sua senha periodicamente e que n√£o passe sua senha para ningu√©m.</p>
            </div>
            <div id="alterar-senha-content">
              <form id="formAlterarSenha" style="max-width: 600px; margin: 0 auto;">
                <div style="display: grid; gap: var(--space-4);">
                  <div>
                    <label for="senhaAtual" style="display: block; font-weight: 600; margin-bottom: var(--space-1); font-size: var(--text-sm); color: var(--text-primary);">
                      Senha Atual <span style="color: var(--error);">*</span>
                    </label>
                    <input
                      type="password"
                      id="senhaAtual"
                      name="senhaAtual"
                      class="modern-form-input"
                      placeholder="Digite sua senha atual"
                      required
                      autocomplete="current-password"
                      style="width: 100%;"
                    />
                  </div>

                  <div>
                    <label for="novaSenha" style="display: block; font-weight: 600; margin-bottom: var(--space-1); font-size: var(--text-sm); color: var(--text-primary);">
                      Nova Senha <span style="color: var(--error);">*</span>
                    </label>
                    <input
                      type="password"
                      id="novaSenha"
                      name="novaSenha"
                      class="modern-form-input"
                      placeholder="Digite sua nova senha"
                      required
                      autocomplete="new-password"
                      minlength="6"
                      style="width: 100%;"
                    />
                    <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-1);">
                      A senha deve ter no m√≠nimo 6 caracteres
                    </div>
                  </div>

                  <div>
                    <label for="confirmarSenha" style="display: block; font-weight: 600; margin-bottom: var(--space-1); font-size: var(--text-sm); color: var(--text-primary);">
                      Confirmar Senha <span style="color: var(--error);">*</span>
                    </label>
                    <input
                      type="password"
                      id="confirmarSenha"
                      name="confirmarSenha"
                      class="modern-form-input"
                      placeholder="Confirme sua nova senha"
                      required
                      autocomplete="new-password"
                      minlength="6"
                      style="width: 100%;"
                    />
                    <div id="senhaMatchMessage" style="display: none; font-size: var(--text-xs); color: var(--error); margin-top: var(--space-1);">
                      As senhas n√£o coincidem
                    </div>
                  </div>

                  <div style="display: flex; gap: var(--space-3); justify-content: flex-end; margin-top: var(--space-2);">
                    <button type="submit" class="modern-form-button primary" style="min-width: 150px;">
                      <span>üîí</span> Alterar Senha
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </section>

          <!-- Configurar Financeiro -->
          <section id="configurar-financeiro" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-wallet"></i> Configurar Financeiro</h2>
              <p>Configure as op√ß√µes do m√≥dulo financeiro do sistema.</p>
            </div>
            <div id="configurar-financeiro-content">
              <form id="formConfigurarFinanceiro" style="max-width: 800px; margin: 0 auto;">
                <div style="display: grid; gap: var(--space-6);">
                  <!-- Configura√ß√£o de Comiss√µes -->
                  <div style="background: var(--gray-50); padding: var(--space-5); border-radius: var(--radius-lg); border: 1px solid var(--gray-200);">
                    <div style="margin-bottom: var(--space-4);">
                      <label style="display: flex; align-items: flex-start; gap: var(--space-2); cursor: pointer;">
                        <input 
                          type="checkbox" 
                          id="permitirGerarReceitasComissoes" 
                          name="permitirGerarReceitasComissoes" 
                          class="modern-form-checkbox"
                          style="margin-top: 4px;"
                        />
                        <span style="flex: 1; font-weight: 500; color: var(--text-primary);">
                          Permitir que o OurSales gere receitas referente √†s minhas comiss√µes.
                        </span>
                      </label>
                    </div>
                    
                    <div style="margin-top: var(--space-4);">
                      <label for="grupoContaComissoes" style="display: block; font-weight: 600; margin-bottom: var(--space-2); font-size: var(--text-sm); color: var(--text-primary);">
                        Grupo de Conta Padr√£o
                      </label>
                      <select
                        id="grupoContaComissoes"
                        name="grupoContaComissoes"
                        class="modern-form-select"
                        style="width: 100%;"
                      >
                        <option value="">Selecione...</option>
                      </select>
                      <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-2);">
                        Seus lan√ßamentos de comiss√£o ser√£o cadastrados nessa categoria.
                      </div>
                    </div>
                  </div>

                  <!-- Configura√ß√£o de Receb√≠veis -->
                  <div style="background: var(--gray-50); padding: var(--space-5); border-radius: var(--radius-lg); border: 1px solid var(--gray-200);">
                    <div style="margin-bottom: var(--space-4);">
                      <label style="display: flex; align-items: flex-start; gap: var(--space-2); cursor: pointer;">
                        <input 
                          type="checkbox" 
                          id="permitirGerarReceitasRecebiveis" 
                          name="permitirGerarReceitasRecebiveis" 
                          class="modern-form-checkbox"
                          style="margin-top: 4px;"
                        />
                        <span style="flex: 1; font-weight: 500; color: var(--text-primary);">
                          Permitir que o OurSales gere receitas referente √†s minhas parcelas de recebimento. <strong style="color: var(--error);">SOMENTE EMISSOR NOVO!</strong>
                        </span>
                      </label>
                    </div>
                    
                    <div style="margin-top: var(--space-4);">
                      <label for="grupoContaRecebiveis" style="display: block; font-weight: 600; margin-bottom: var(--space-2); font-size: var(--text-sm); color: var(--text-primary);">
                        Grupo de Conta Padr√£o
                      </label>
                      <select
                        id="grupoContaRecebiveis"
                        name="grupoContaRecebiveis"
                        class="modern-form-select"
                        style="width: 100%;"
                      >
                        <option value="">Selecione...</option>
                      </select>
                      <div style="font-size: var(--text-xs); color: var(--text-tertiary); margin-top: var(--space-2);">
                        Suas parcelas de recebimento ser√£o cadastrados nessa categoria.
                      </div>
                    </div>
                  </div>

                  <!-- Bot√£o de Salvar -->
                  <div style="display: flex; justify-content: flex-start; margin-top: var(--space-2);">
                    <button type="submit" class="modern-form-button primary" style="min-width: 180px;">
                      <i class="ti ti-device-floppy"></i> Salvar Altera√ß√µes
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </section>

          <!-- Personalizar Campos -->
          <section id="personalizar-campos" class="config-section">
            <div class="config-section-header">
              <h2><i class="ti ti-palette"></i> Personalizar Campos</h2>
              <p>Personalize os campos dos formul√°rios de cadastros.</p>
            </div>
            <div id="personalizar-campos-content">
              <div style="max-width: 700px; margin: 0 auto;">
                <p style="color: var(--text-primary); font-size: var(--text-base); margin-bottom: var(--space-6);">
                  Escolha qual <strong>formul√°rio</strong> abaixo deseja personalizar:
                </p>
                
                <div style="display: grid; gap: var(--space-2);">
                  <a 
                    href="#personalizar-industrias" 
                    class="personalizar-campo-link"
                    data-form="industrias"
                  >
                    <span style="margin-right: var(--space-2);">¬ª</span>
                    Ind√∫strias
                  </a>
                  
                  <a 
                    href="#personalizar-produtos" 
                    class="personalizar-campo-link"
                    data-form="produtos"
                  >
                    <span style="margin-right: var(--space-2);">¬ª</span>
                    Produtos
                  </a>
                  
                  <a 
                    href="#personalizar-clientes" 
                    class="personalizar-campo-link"
                    data-form="clientes"
                  >
                    <span style="margin-right: var(--space-2);">¬ª</span>
                    Clientes
                  </a>
                  
                  <a 
                    href="#personalizar-contatos" 
                    class="personalizar-campo-link"
                    data-form="contatos"
                  >
                    <span style="margin-right: var(--space-2);">¬ª</span>
                    Contatos
                  </a>
                  
                  <a 
                    href="#personalizar-pedidos" 
                    class="personalizar-campo-link"
                    data-form="pedidos"
                  >
                    <span style="margin-right: var(--space-2);">¬ª</span>
                    Pedidos
                  </a>
                  
                  <a 
                    href="#personalizar-financeiro" 
                    class="personalizar-campo-link"
                    data-form="financeiro"
                  >
                    <span style="margin-right: var(--space-2);">¬ª</span>
                    <strong>Financeiro</strong> - Lan√ßamentos
                  </a>
                  
                  <a 
                    href="#personalizar-ecommerce" 
                    class="personalizar-campo-link"
                    data-form="ecommerce"
                  >
                    <span style="margin-right: var(--space-2);">¬ª</span>
                    E-commerce
                  </a>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </main>

    <footer>
      OurSales ‚Ä¢ Sistema de Gest√£o Comercial ‚Ä¢ Desenvolvido para otimizar sua opera√ß√£o
    </footer>

    <script src="assets/js/api.js"></script>
    <script src="assets/js/app.js" defer></script>
    <script>
      // Inicializar funcionalidade de importa√ß√£o de produtos
      function initImportarProdutos() {
        // Verificar se a API est√° dispon√≠vel
        if (!window.oursalesAPI) {
          console.error("API n√£o carregada. Recarregue a p√°gina.");
          return;
        }

        const industriaSelect = document.getElementById("industriaSelect");
        const tabelaPrecoSelect = document.getElementById("tabelaPrecoSelect");
        const arquivoInput = document.getElementById("arquivoInput");
        const importForm = document.getElementById("importForm");
        const downloadTemplateExcelBtn = document.getElementById("downloadTemplateExcel");
        const downloadTemplateExcelBottomBtn = document.getElementById("downloadTemplateExcelBottom");

        if (!industriaSelect || !tabelaPrecoSelect || !importForm) {
          console.warn("Elementos do formul√°rio de importa√ß√£o n√£o encontrados");
          return;
        }

        // Carregar ind√∫strias
        async function carregarIndustrias() {
          try {
            const response = await window.oursalesAPI.getIndustrias();
            const industrias = response.data || response || [];

            industriaSelect.innerHTML = '<option value="">Selecione...</option>';

            if (industrias.length === 0) {
              const option = document.createElement("option");
              option.value = "";
              option.textContent = "Nenhuma ind√∫stria cadastrada";
              option.disabled = true;
              industriaSelect.appendChild(option);
              return;
            }

            industrias.forEach((industria) => {
              const option = document.createElement("option");
              option.value = industria.id;
              option.textContent = industria.nomeFantasia || industria.nome || industria.razaoSocial;
              industriaSelect.appendChild(option);
            });
          } catch (error) {
            console.error("Erro ao carregar ind√∫strias:", error);
            industriaSelect.innerHTML = '<option value="">Erro ao carregar ind√∫strias</option>';
          }
        }

        // Carregar tabelas de pre√ßos quando ind√∫stria for selecionada
        industriaSelect.addEventListener("change", async function () {
          const industriaId = this.value;
          tabelaPrecoSelect.innerHTML = '<option value="">Selecione...</option>';

          if (industriaId) {
            tabelaPrecoSelect.disabled = false;
            try {
              const response = await window.oursalesAPI.getTabelasPrecos(industriaId);
              const tabelas = response.data || response || [];

              if (tabelas.length === 0) {
                const option = document.createElement("option");
                option.value = "";
                option.textContent = "Nenhuma tabela cadastrada";
                option.disabled = true;
                tabelaPrecoSelect.appendChild(option);
              } else {
                tabelas.forEach((tabela) => {
                  const option = document.createElement("option");
                  option.value = tabela.id;
                  option.textContent = tabela.nome;
                  tabelaPrecoSelect.appendChild(option);
                });
              }
            } catch (error) {
              console.error("Erro ao carregar tabelas de pre√ßos:", error);
              const option = document.createElement("option");
              option.value = "";
              option.textContent = "Erro ao carregar tabelas";
              option.disabled = true;
              tabelaPrecoSelect.appendChild(option);
            }
          } else {
            tabelaPrecoSelect.disabled = true;
          }
        });

        // Mapeamento de campos
        const camposMap = {
          codigo: { header: "C√≥digo", obrigatorio: true },
          nome: { header: "Nome do produto", obrigatorio: false },
          preco: { header: "Pre√ßo", obrigatorio: false },
          unidade: { header: "Unidade", obrigatorio: false },
          embalagem: { header: "Embalagem", obrigatorio: false },
          fatorEmbalagem: { header: "Fator de Embalagem", obrigatorio: false },
          dataLancamento: { header: "Data de Lan√ßamento", obrigatorio: false },
          ipi: { header: "IPI", obrigatorio: false },
          icms: { header: "ICMS %", obrigatorio: false },
          cest: { header: "CEST", obrigatorio: false },
          cfop: { header: "CFOP", obrigatorio: false },
          observacoes: { header: "Observa√ß√µes", obrigatorio: false },
          comissaoProduto: { header: "Comiss√£o por produto", obrigatorio: false },
          codigoBarras: { header: "C√≥digo de barras", obrigatorio: false },
          stUf: { header: "ST-UF", obrigatorio: false },
        };

        // Fun√ß√£o para obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll("#importar-produtos-content .field-checkbox");
          const fieldNames = document.querySelectorAll("#importar-produtos-content .field-name");

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(key => camposMap[key].header === fieldName);
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          if (!camposSelecionados.includes("codigo")) {
            camposSelecionados.unshift("codigo");
          }

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === "undefined") {
            alert("Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.");
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map(key => camposMap[key].header);
          const dados = [headers];
          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 20 }));
          worksheet["!cols"] = colWidths;
          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, "Produtos");
          XLSX.writeFile(workbook, "modelo_importacao_produtos.xlsx");
        }

        // Processar arquivo
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith(".xlsx") || fileName.endsWith(".xls") || fileName.endsWith(".xlsm");

            if (isExcel) {
              if (typeof XLSX === "undefined") {
                reject(new Error("Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina."));
                return;
              }

              const reader = new FileReader();
              reader.onload = function (e) {
                try {
                  const arrayBuffer = e.target.result;
                  const workbook = XLSX.read(arrayBuffer, { type: "array" });
                  const firstSheetName = workbook.SheetNames[0];
                  const worksheet = workbook.Sheets[firstSheetName];
                  const dados = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: "" });

                  if (dados.length < 2) {
                    reject(new Error("Arquivo Excel n√£o cont√©m dados v√°lidos"));
                    return;
                  }

                  const headers = dados[0].map(h => String(h).trim().toLowerCase());
                  const resultado = [];
                  for (let i = 1; i < dados.length; i++) {
                    const linha = dados[i];
                    if (linha.some(cell => cell !== "")) {
                      const linhaObj = {};
                      headers.forEach((header, index) => {
                        linhaObj[header] = linha[index] ? String(linha[index]).trim() : "";
                      });
                      resultado.push(linhaObj);
                    }
                  }
                  resolve(resultado);
                } catch (error) {
                  reject(error);
                }
              };
              reader.onerror = () => reject(new Error("Erro ao ler arquivo Excel"));
              reader.readAsArrayBuffer(arquivo);
            } else {
              reject(new Error("Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos"));
            }
          });
        }

        // Event listeners
        downloadTemplateExcelBtn?.addEventListener("click", downloadTemplateExcel);
        downloadTemplateExcelBottomBtn?.addEventListener("click", downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm.addEventListener("submit", async function (e) {
          e.preventDefault();

          const industriaId = industriaSelect.value;
          const tabelaPrecoId = tabelaPrecoSelect.value;
          const arquivo = arquivoInput.files[0];

          if (!industriaId || !tabelaPrecoId || !arquivo) {
            alert("Por favor, preencha todos os campos obrigat√≥rios.");
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            if (dados.length === 0) {
              alert("Arquivo n√£o cont√©m dados v√°lidos.");
              return;
            }

            const submitBtn = importForm.querySelector('button[type="submit"]');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = "Processando...";
            submitBtn.disabled = true;

            const dadosNormalizados = dados.map((linha) => {
              const codigo = linha.codigo || linha.c√≥digo || linha.Codigo || linha.C√≥digo || null;
              const nome = linha.nome || linha["nome do produto"] || linha["Nome do produto"] || linha.Nome || null;
              const stUf = linha["st-uf"] || linha.stuf || linha.st_uf || linha["ST-UF"] || linha.STUF || linha.ST_UF || null;
              let observacoes = linha.observacoes || "";
              if (stUf) {
                observacoes = observacoes ? `${observacoes}\nST-UF: ${stUf}` : `ST-UF: ${stUf}`;
              }

              return {
                codigo,
                nome,
                preco: linha.preco || linha.pre√ßo || linha.Pre√ßo || "0",
                unidade: linha.unidade || "UNID",
                embalagem: linha.embalagem || "",
                fatorEmbalagem: linha.fatorEmbalagem || linha["fator de embalagem"] || null,
                dataLancamento: linha.dataLancamento || linha["data de lan√ßamento"] || null,
                ipi: linha.ipi || linha.IPI || "0",
                icms: linha.icms || linha["icms %"] || linha["ICMS %"] || null,
                cest: linha.cest || linha.CEST || null,
                cfop: linha.cfop || linha.CFOP || null,
                observacoes: observacoes,
                comissaoProduto: linha.comissaoProduto || linha["comiss√£o por produto"] || null,
                codigoBarras: linha.codigoBarras || linha["c√≥digo de barras"] || null,
                stUf: stUf,
              };
            });

            const result = await window.oursalesAPI.importarProdutos(industriaId, tabelaPrecoId, dadosNormalizados);

            let mensagem = `Importa√ß√£o conclu√≠da!\n\n`;
            mensagem += `Produtos importados: ${result.data?.totalImportados || result.data?.importados || 0}\n`;
            mensagem += `Erros: ${result.data?.totalErros || result.data?.erros?.length || 0}\n`;

            if (result.data?.erros && result.data.erros.length > 0) {
              mensagem += `\nErros encontrados:\n`;
              result.data.erros.slice(0, 5).forEach((erro) => {
                mensagem += `‚Ä¢ Linha ${erro.linha}: ${erro.erro}\n`;
              });
              if (result.data.erros.length > 5) {
                mensagem += `... e mais ${result.data.erros.length - 5} erros`;
              }
            }

            alert(mensagem);
            importForm.reset();
            tabelaPrecoSelect.disabled = true;
          } catch (error) {
            console.error("Erro na importa√ß√£o:", error);
            alert("Erro ao processar arquivo: " + (error.message || "Verifique o formato e tente novamente."));
          } finally {
            const submitBtn = importForm.querySelector('button[type="submit"]');
            if (submitBtn) {
              submitBtn.innerHTML = '<i class="ti ti-upload"></i> Importar Produtos';
              submitBtn.disabled = false;
            }
          }
        });

        // Inicializar
        carregarIndustrias();
      }

      // Inicializar importa√ß√£o de ind√∫strias
      function initImportarIndustrias() {
        if (typeof XLSX === 'undefined') {
          console.error('SheetJS n√£o est√° carregado');
          return;
        }

        const API_BASE = 'http://localhost:3000/api';
        const downloadBtnTop = document.getElementById('downloadTemplateExcelIndustrias');
        const downloadBtnBottom = document.getElementById('downloadTemplateExcelIndustriasBottom');
        const importForm = document.getElementById('importFormIndustrias');
        const arquivoInput = document.getElementById('arquivoInputIndustrias');

        // Mapeamento de campos
        const camposMap = {
          razaoSocial: {
            header: 'Raz√£o Social',
            checkboxId: 'checkboxRazaoSocial',
            obrigatorio: true,
          },
          nomeFantasia: {
            header: 'Nome Fantasia',
            checkboxId: null,
            obrigatorio: false,
          },
          cnpj: {
            header: 'CNPJ',
            checkboxId: 'checkboxCNPJ',
            obrigatorio: true,
          },
          inscricaoEstadual: {
            header: 'Inscri√ß√£o Estadual',
            checkboxId: null,
            obrigatorio: false,
          },
          email: {
            header: 'E-mail',
            checkboxId: null,
            obrigatorio: false,
          },
          comissao: {
            header: 'Comiss√£o',
            checkboxId: null,
            obrigatorio: false,
          },
          endereco: {
            header: 'Endere√ßo',
            checkboxId: null,
            obrigatorio: false,
          },
          bairro: {
            header: 'Bairro',
            checkboxId: null,
            obrigatorio: false,
          },
          cep: {
            header: 'CEP',
            checkboxId: null,
            obrigatorio: false,
          },
          cidade: {
            header: 'Cidade',
            checkboxId: null,
            obrigatorio: false,
          },
          estado: {
            header: 'Estado',
            checkboxId: null,
            obrigatorio: false,
          },
          telefone: {
            header: 'Telefone',
            checkboxId: null,
            obrigatorio: false,
          },
          telefoneAdicional: {
            header: 'Telefone Adicional',
            checkboxId: null,
            obrigatorio: false,
          },
          fax: {
            header: 'Fax',
            checkboxId: null,
            obrigatorio: false,
          },
          website: {
            header: 'Website',
            checkboxId: null,
            obrigatorio: false,
          },
          observacoes: {
            header: 'Observa√ß√µes',
            checkboxId: null,
            obrigatorio: false,
          },
        };

        // Obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll('#importar-industrias-content .field-checkbox');
          const fieldNames = document.querySelectorAll('#importar-industrias-content .field-name');

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(
                  (key) => camposMap[key].header === fieldName
                );
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === 'undefined') {
            alert('Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.');
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map((key) => camposMap[key].header);
          const dados = [headers];

          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 20 }));
          worksheet['!cols'] = colWidths;

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Ind√∫strias');
          XLSX.writeFile(workbook, 'modelo_importacao_industrias.xlsx');
        }

        // Processar arquivo Excel
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || fileName.endsWith('.xlsm');

            if (!isExcel) {
              reject(new Error('Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos'));
              return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
              try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                if (jsonData.length < 2) {
                  reject(new Error('O arquivo est√° vazio ou n√£o possui dados'));
                  return;
                }

                const headers = jsonData[0].map((h) => String(h || '').trim());
                const dados = [];

                for (let i = 1; i < jsonData.length; i++) {
                  const linha = jsonData[i];
                  if (linha.every((cell) => !cell || String(cell).trim() === '')) continue;

                  const objeto = {};
                  headers.forEach((header, index) => {
                    const valor = linha[index];
                    objeto[header] = valor !== undefined && valor !== null ? String(valor).trim() : '';
                  });
                  dados.push(objeto);
                }

                resolve(dados);
              } catch (error) {
                reject(error);
              }
            };

            reader.onerror = function () {
              reject(new Error('Erro ao ler arquivo'));
            };

            reader.readAsArrayBuffer(arquivo);
          });
        }

        // Event listeners
        downloadBtnTop?.addEventListener('click', downloadTemplateExcel);
        downloadBtnBottom?.addEventListener('click', downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm?.addEventListener('submit', async function (e) {
          e.preventDefault();

          const arquivo = arquivoInput.files[0];
          if (!arquivo) {
            alert('Selecione um arquivo para importar');
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            
            // Normalizar dados
            const dadosNormalizados = dados.map((linha) => {
              const razaoSocial = linha['Raz√£o Social'] || linha['razao social'] || linha.razaoSocial || linha.RazaoSocial || '';
              const cnpj = linha.CNPJ || linha.cnpj || linha.Cnpj || '';

              return {
                razaoSocial: razaoSocial,
                nomeFantasia: linha['Nome Fantasia'] || linha['nome fantasia'] || linha.nomeFantasia || linha.NomeFantasia || linha['Nome Fantasia'] || '',
                cnpj: cnpj.replace(/\D/g, ''),
                inscricaoEstadual: linha['Inscri√ß√£o Estadual'] || linha['inscri√ß√£o estadual'] || linha.inscricaoEstadual || '',
                email: linha['E-mail'] || linha.email || linha.Email || linha['E-mail'] || '',
                comissao: linha.Comiss√£o || linha.comissao || linha.Comissao || '0',
                endereco: linha.Endere√ßo || linha.endereco || linha.Endereco || '',
                bairro: linha.Bairro || linha.bairro || linha.Bairro || '',
                cep: (linha.CEP || linha.cep || linha.Cep || '').replace(/\D/g, ''),
                cidade: linha.Cidade || linha.cidade || linha.Cidade || '',
                estado: (linha.Estado || linha.estado || linha.Estado || '').toUpperCase().substring(0, 2),
                telefone: linha.Telefone || linha.telefone || linha.Telefone || '',
                telefoneAdicional: linha['Telefone Adicional'] || linha['telefone adicional'] || linha.telefoneAdicional || '',
                fax: linha.Fax || linha.fax || linha.Fax || '',
                website: linha.Website || linha.website || linha.Website || '',
                observacoes: linha.Observa√ß√µes || linha.observacoes || linha.Observacoes || '',
              };
            });

            // Verificar se h√° token de autentica√ß√£o
            const token = localStorage.getItem('oursales:auth-token');

            if (!token) {
              // Importa√ß√£o local
              const data = JSON.parse(localStorage.getItem('oursales:data') || '{}');
              if (!data.industrias) data.industrias = [];

              let importados = 0;
              let erros = [];

              dadosNormalizados.forEach((linha, index) => {
                try {
                  // Verificar se j√° existe
                  const existe = data.industrias.some(
                    (ind) => ind.cnpj?.replace(/\D/g, '') === linha.cnpj
                  );

                  if (existe) {
                    erros.push({
                      linha: index + 2,
                      erro: 'Ind√∫stria com este CNPJ j√° existe',
                    });
                    return;
                  }

                  const novaIndustria = {
                    id: `ind-${Date.now()}-${index}`,
                    razaoSocial: linha.razaoSocial,
                    nomeFantasia: linha.nomeFantasia || linha.razaoSocial,
                    cnpj: linha.cnpj,
                    inscricaoEstadual: linha.inscricaoEstadual || '',
                    email: linha.email || '',
                    comissao: parseFloat(linha.comissao) || 0,
                    endereco: linha.endereco || '',
                    bairro: linha.bairro || '',
                    cep: linha.cep || '',
                    cidade: linha.cidade || '',
                    estado: linha.estado || '',
                    telefone: linha.telefone || '',
                    telefoneAdicional: linha.telefoneAdicional || '',
                    fax: linha.fax || '',
                    website: linha.website || '',
                    observacoes: linha.observacoes || '',
                    status: 'ativo',
                    tabelasPrecos: [],
                    contatos: [],
                    condicoesPagamento: [],
                    criadoEm: new Date().toISOString(),
                  };

                  data.industrias.push(novaIndustria);
                  importados++;
                } catch (error) {
                  erros.push({
                    linha: index + 2,
                    erro: error.message,
                  });
                }
              });

              localStorage.setItem('oursales:data', JSON.stringify(data));

              if (erros.length > 0) {
                alert(`Importa√ß√£o conclu√≠da com erros:\n${importados} importados\n${erros.length} erros\n\nPrimeiro erro: ${erros[0].erro} (linha ${erros[0].linha})`);
              } else {
                alert(`${importados} ind√∫stria(s) importada(s) com sucesso!`);
              }

              // Recarregar p√°gina
              window.location.reload();
            } else {
              // Importa√ß√£o via API
              const response = await fetch(`${API_BASE}/industrias/importar`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({
                  dados: dadosNormalizados,
                }),
              });

              const result = await response.json();

              if (response.ok) {
                alert(`${result.importados || dadosNormalizados.length} ind√∫stria(s) importada(s) com sucesso!`);
                window.location.reload();
              } else {
                alert(`Erro na importa√ß√£o: ${result.message || 'Erro desconhecido'}`);
              }
            }
          } catch (error) {
            alert(`Erro ao processar arquivo: ${error.message}`);
          }
        });
      }

      // Fun√ß√£o para inicializar importa√ß√£o de contatos
      function initImportarContatos() {
        const API_BASE = 'http://localhost:3000/api';
        const downloadBtnTop = document.getElementById('downloadTemplateExcelContatos');
        const downloadBtnBottom = document.getElementById('downloadTemplateExcelContatosBottom');
        const importForm = document.getElementById('importFormContatos');
        const arquivoInput = document.getElementById('arquivoInputContatos');

        if (!downloadBtnTop || !downloadBtnBottom || !importForm || !arquivoInput) {
          return;
        }

        // Mapeamento de campos
        const camposMap = {
          codigoCliente: {
            header: 'C√≥digo do Cliente ou CNPJ/CPF',
            checkboxId: 'checkboxCodigoCliente',
            obrigatorio: false,
          },
          nome: {
            header: 'Nome',
            checkboxId: 'checkboxNomeContato',
            obrigatorio: true,
          },
          email: {
            header: 'E-mail',
            checkboxId: null,
            obrigatorio: false,
          },
          departamento: {
            header: 'Departamento',
            checkboxId: null,
            obrigatorio: false,
          },
          cargo: {
            header: 'Cargo',
            checkboxId: null,
            obrigatorio: false,
          },
          celular: {
            header: 'Celular',
            checkboxId: null,
            obrigatorio: false,
          },
          telefoneFixo: {
            header: 'Telefone Fixo',
            checkboxId: null,
            obrigatorio: false,
          },
          whatsapp: {
            header: 'WhatsApp',
            checkboxId: null,
            obrigatorio: false,
          },
          nextel: {
            header: 'Nextel',
            checkboxId: null,
            obrigatorio: false,
          },
          dataAniversario: {
            header: 'Data Anivers√°rio',
            checkboxId: null,
            obrigatorio: false,
          },
          observacoes: {
            header: 'Observa√ß√µes',
            checkboxId: null,
            obrigatorio: false,
          },
          comprador: {
            header: 'Comprador',
            checkboxId: null,
            obrigatorio: false,
          },
          telegram: {
            header: 'Telegram',
            checkboxId: null,
            obrigatorio: false,
          },
          emailSecundario: {
            header: 'E-mail Secund√°rio',
            checkboxId: null,
            obrigatorio: false,
          },
          telefoneSecundario: {
            header: 'Telefone Secund√°rio',
            checkboxId: null,
            obrigatorio: false,
          },
          twitter: {
            header: 'Twitter',
            checkboxId: null,
            obrigatorio: false,
          },
        };

        // Obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll('#importar-contatos-content .field-checkbox');
          const fieldNames = document.querySelectorAll('#importar-contatos-content .field-name');

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(
                  (key) => camposMap[key].header === fieldName
                );
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === 'undefined') {
            alert('Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.');
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map((key) => camposMap[key].header);
          const dados = [headers];

          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 25 }));
          worksheet['!cols'] = colWidths;

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Contatos');
          XLSX.writeFile(workbook, 'modelo_importacao_contatos.xlsx');
        }

        // Processar arquivo Excel
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || fileName.endsWith('.xlsm');

            if (!isExcel) {
              reject(new Error('Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos'));
              return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
              try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                if (jsonData.length < 2) {
                  reject(new Error('O arquivo est√° vazio ou n√£o possui dados'));
                  return;
                }

                const headers = jsonData[0].map((h) => String(h || '').trim());
                const dados = [];

                for (let i = 1; i < jsonData.length; i++) {
                  const linha = jsonData[i];
                  if (linha.every((cell) => !cell || String(cell).trim() === '')) continue;

                  const objeto = {};
                  headers.forEach((header, index) => {
                    const valor = linha[index];
                    objeto[header] = valor !== undefined && valor !== null ? String(valor).trim() : '';
                  });
                  dados.push(objeto);
                }

                resolve(dados);
              } catch (error) {
                reject(error);
              }
            };

            reader.onerror = function () {
              reject(new Error('Erro ao ler arquivo'));
            };

            reader.readAsArrayBuffer(arquivo);
          });
        }

        // Normalizar dados
        function normalizarDados(dados) {
          return dados.map((linha) => {
            const normalizado = {};
            
            // Normalizar nome
            normalizado.nome = linha['Nome'] || linha['nome'] || linha['NOME'] || '';
            
            // Normalizar c√≥digo do cliente ou CNPJ/CPF
            normalizado.codigoCliente = linha['C√≥digo do Cliente ou CNPJ/CPF'] || linha['codigoCliente'] || linha['C√≥digo Cliente'] || linha['CNPJ/CPF'] || '';
            
            // Normalizar email
            normalizado.email = linha['E-mail'] || linha['email'] || linha['Email'] || linha['EMAIL'] || '';
            
            // Normalizar departamento
            normalizado.departamento = linha['Departamento'] || linha['departamento'] || '';
            
            // Normalizar cargo
            normalizado.cargo = linha['Cargo'] || linha['cargo'] || '';
            
            // Normalizar celular
            normalizado.celular = linha['Celular'] || linha['celular'] || '';
            
            // Normalizar telefone fixo
            normalizado.telefoneFixo = linha['Telefone Fixo'] || linha['telefoneFixo'] || linha['Telefone'] || '';
            
            // Normalizar WhatsApp
            normalizado.whatsapp = linha['WhatsApp'] || linha['whatsapp'] || linha['Whatsapp'] || '';
            
            // Normalizar Nextel
            normalizado.nextel = linha['Nextel'] || linha['nextel'] || '';
            
            // Normalizar data anivers√°rio
            normalizado.dataAniversario = linha['Data Anivers√°rio'] || linha['dataAniversario'] || linha['Anivers√°rio'] || '';
            
            // Normalizar observa√ß√µes
            normalizado.observacoes = linha['Observa√ß√µes'] || linha['observacoes'] || linha['Observacoes'] || '';
            
            // Normalizar comprador (Sim/N√£o)
            const compradorStr = (linha['Comprador'] || linha['comprador'] || '').toString().toLowerCase();
            normalizado.comprador = compradorStr === 'sim' || compradorStr === 's' || compradorStr === 'yes' || compradorStr === 'true' || compradorStr === '1';
            
            // Normalizar Telegram
            normalizado.telegram = linha['Telegram'] || linha['telegram'] || '';
            
            // Normalizar email secund√°rio
            normalizado.emailSecundario = linha['E-mail Secund√°rio'] || linha['emailSecundario'] || linha['Email Secund√°rio'] || '';
            
            // Normalizar telefone secund√°rio
            normalizado.telefoneSecundario = linha['Telefone Secund√°rio'] || linha['telefoneSecundario'] || '';
            
            // Normalizar Twitter
            normalizado.twitter = linha['Twitter'] || linha['twitter'] || '';

            return normalizado;
          });
        }

        // Event listeners
        downloadBtnTop?.addEventListener('click', downloadTemplateExcel);
        downloadBtnBottom?.addEventListener('click', downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm?.addEventListener('submit', async function (e) {
          e.preventDefault();

          const arquivo = arquivoInput.files[0];
          if (!arquivo) {
            alert('Selecione um arquivo para importar');
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            if (dados.length === 0) {
              alert('Nenhum dado encontrado no arquivo');
              return;
            }

            const dadosNormalizados = normalizarDados(dados);
            const token = localStorage.getItem('oursales:auth-token');

            if (!token) {
              // Importa√ß√£o local
              const storage = {
                load: () => {
                  const data = localStorage.getItem('oursales:data');
                  return data ? JSON.parse(data) : { clientes: [], contatos: [] };
                },
                save: (data) => {
                  localStorage.setItem('oursales:data', JSON.stringify(data));
                },
              };

              const data = storage.load();
              if (!data.contatos) {
                data.contatos = [];
              }

              let importados = 0;
              dadosNormalizados.forEach((contato) => {
                // Verificar se j√° existe contato com mesmo nome e email
                const existe = data.contatos.find(
                  (c) => c.nome === contato.nome && c.email === contato.email
                );

                if (!existe) {
                  const novoContato = {
                    id: `cont-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                    nome: contato.nome,
                    email: contato.email,
                    departamento: contato.departamento || '',
                    cargo: contato.cargo || '',
                    celular: contato.celular || '',
                    telefoneFixo: contato.telefoneFixo || '',
                    whatsapp: contato.whatsapp || '',
                    nextel: contato.nextel || '',
                    dataAniversario: contato.dataAniversario || '',
                    observacoes: contato.observacoes || '',
                    comprador: contato.comprador || false,
                    telegram: contato.telegram || '',
                    emailSecundario: contato.emailSecundario || '',
                    telefoneSecundario: contato.telefoneSecundario || '',
                    twitter: contato.twitter || '',
                    codigoCliente: contato.codigoCliente || '',
                    criadoEm: new Date().toISOString(),
                  };
                  data.contatos.push(novoContato);
                  importados++;
                }
              });

              storage.save(data);
              alert(`${importados} contato(s) importado(s) com sucesso!`);
              window.location.reload();
            } else {
              // Importa√ß√£o via API
              const response = await fetch(`${API_BASE}/contatos/importar`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({
                  dados: dadosNormalizados,
                }),
              });

              const result = await response.json();

              if (response.ok) {
                alert(`${result.importados || dadosNormalizados.length} contato(s) importado(s) com sucesso!`);
                window.location.reload();
              } else {
                alert(`Erro na importa√ß√£o: ${result.message || 'Erro desconhecido'}`);
              }
            }
          } catch (error) {
            alert(`Erro ao processar arquivo: ${error.message}`);
          }
        });
      }

      // Fun√ß√£o para inicializar importa√ß√£o de faturamento
      function initImportarFaturamento() {
        const API_BASE = 'http://localhost:3000/api';
        const downloadBtnTop = document.getElementById('downloadTemplateExcelFaturamento');
        const downloadBtnBottom = document.getElementById('downloadTemplateExcelFaturamentoBottom');
        const importForm = document.getElementById('importFormFaturamento');
        const arquivoInput = document.getElementById('arquivoInputFaturamento');

        if (!downloadBtnTop || !downloadBtnBottom || !importForm || !arquivoInput) {
          return;
        }

        // Mapeamento de campos
        const camposMap = {
          clienteCnpjCpf: {
            header: 'Cliente - CNPJ/CPF',
            checkboxId: null,
            obrigatorio: false,
          },
          industriaCnpj: {
            header: 'Ind√∫stria - CNPJ',
            checkboxId: null,
            obrigatorio: false,
          },
          notaFiscal: {
            header: 'Nota Fiscal',
            checkboxId: 'checkboxNotaFiscal',
            obrigatorio: true,
          },
          dataFatura: {
            header: 'Data de Fatura',
            checkboxId: 'checkboxDataFatura',
            obrigatorio: true,
          },
          dataLiquidez: {
            header: 'Data de Liquidez',
            checkboxId: 'checkboxDataLiquidez',
            obrigatorio: true,
          },
          valorParcela: {
            header: 'Valor da Parcela',
            checkboxId: 'checkboxValorParcela',
            obrigatorio: true,
          },
          valorComissao: {
            header: 'Valor da Comiss√£o',
            checkboxId: 'checkboxValorComissao',
            obrigatorio: true,
          },
          comissaoPedido: {
            header: 'Comiss√£o do Pedido',
            checkboxId: null,
            obrigatorio: false,
          },
          baseCalculo: {
            header: 'Base de C√°lculo',
            checkboxId: null,
            obrigatorio: false,
          },
          ordemCompra: {
            header: 'Ordem de Compra',
            checkboxId: null,
            obrigatorio: false,
          },
          pedidoIndustria: {
            header: 'Pedido na Ind√∫stria',
            checkboxId: null,
            obrigatorio: false,
          },
          pedidoOurSales: {
            header: 'Pedido no OurSales',
            checkboxId: null,
            obrigatorio: false,
          },
          dataRecebimentoComissao: {
            header: 'Data Recebimento da Comiss√£o',
            checkboxId: null,
            obrigatorio: false,
          },
          emailVendedor: {
            header: 'E-mail do Vendedor',
            checkboxId: null,
            obrigatorio: false,
          },
        };

        // Obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll('#importar-faturamento-content .field-checkbox');
          const fieldNames = document.querySelectorAll('#importar-faturamento-content .field-name');

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(
                  (key) => camposMap[key].header === fieldName
                );
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === 'undefined') {
            alert('Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.');
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map((key) => camposMap[key].header);
          const dados = [headers];

          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 25 }));
          worksheet['!cols'] = colWidths;

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Faturamento');
          XLSX.writeFile(workbook, 'modelo_importacao_faturamento.xlsx');
        }

        // Processar arquivo Excel
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || fileName.endsWith('.xlsm');

            if (!isExcel) {
              reject(new Error('Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos'));
              return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
              try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                if (jsonData.length < 2) {
                  reject(new Error('O arquivo est√° vazio ou n√£o possui dados'));
                  return;
                }

                // Validar limite de 500 parcelas
                if (jsonData.length - 1 > 500) {
                  reject(new Error('O arquivo excede o limite de 500 parcelas por arquivo'));
                  return;
                }

                const headers = jsonData[0].map((h) => String(h || '').trim());
                const dados = [];

                for (let i = 1; i < jsonData.length; i++) {
                  const linha = jsonData[i];
                  if (linha.every((cell) => !cell || String(cell).trim() === '')) continue;

                  const objeto = {};
                  headers.forEach((header, index) => {
                    const valor = linha[index];
                    objeto[header] = valor !== undefined && valor !== null ? String(valor).trim() : '';
                  });
                  dados.push(objeto);
                }

                resolve(dados);
              } catch (error) {
                reject(error);
              }
            };

            reader.onerror = function () {
              reject(new Error('Erro ao ler arquivo'));
            };

            reader.readAsArrayBuffer(arquivo);
          });
        }

        // Normalizar dados
        function normalizarDados(dados) {
          return dados.map((linha) => {
            const normalizado = {};
            
            // Normalizar cliente CNPJ/CPF
            normalizado.clienteCnpjCpf = linha['Cliente - CNPJ/CPF'] || linha['clienteCnpjCpf'] || linha['Cliente CNPJ/CPF'] || '';
            
            // Normalizar ind√∫stria CNPJ
            normalizado.industriaCnpj = linha['Ind√∫stria - CNPJ'] || linha['industriaCnpj'] || linha['Ind√∫stria CNPJ'] || '';
            
            // Normalizar nota fiscal
            normalizado.notaFiscal = linha['Nota Fiscal'] || linha['notaFiscal'] || linha['NotaFiscal'] || '';
            
            // Normalizar data de fatura
            normalizado.dataFatura = linha['Data de Fatura'] || linha['dataFatura'] || linha['DataFatura'] || '';
            
            // Normalizar data de liquidez
            normalizado.dataLiquidez = linha['Data de Liquidez'] || linha['dataLiquidez'] || linha['DataLiquidez'] || '';
            
            // Normalizar valor da parcela
            normalizado.valorParcela = linha['Valor da Parcela'] || linha['valorParcela'] || linha['ValorParcela'] || '';
            
            // Normalizar valor da comiss√£o
            normalizado.valorComissao = linha['Valor da Comiss√£o'] || linha['valorComissao'] || linha['ValorComissao'] || '';
            
            // Normalizar comiss√£o do pedido
            normalizado.comissaoPedido = linha['Comiss√£o do Pedido'] || linha['comissaoPedido'] || linha['ComissaoPedido'] || '0';
            
            // Normalizar base de c√°lculo
            normalizado.baseCalculo = linha['Base de C√°lculo'] || linha['baseCalculo'] || linha['BaseCalculo'] || '';
            
            // Normalizar ordem de compra
            normalizado.ordemCompra = linha['Ordem de Compra'] || linha['ordemCompra'] || linha['OrdemCompra'] || '';
            
            // Normalizar pedido na ind√∫stria
            normalizado.pedidoIndustria = linha['Pedido na Ind√∫stria'] || linha['pedidoIndustria'] || linha['PedidoIndustria'] || '';
            
            // Normalizar pedido no OurSales
            normalizado.pedidoOurSales = linha['Pedido no OurSales'] || linha['pedidoOurSales'] || linha['PedidoOurSales'] || '';
            
            // Normalizar data recebimento da comiss√£o
            normalizado.dataRecebimentoComissao = linha['Data Recebimento da Comiss√£o'] || linha['dataRecebimentoComissao'] || linha['DataRecebimentoComissao'] || '';
            
            // Normalizar e-mail do vendedor
            normalizado.emailVendedor = linha['E-mail do Vendedor'] || linha['emailVendedor'] || linha['EmailVendedor'] || '';

            return normalizado;
          });
        }

        // Event listeners
        downloadBtnTop?.addEventListener('click', downloadTemplateExcel);
        downloadBtnBottom?.addEventListener('click', downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm?.addEventListener('submit', async function (e) {
          e.preventDefault();

          const arquivo = arquivoInput.files[0];
          if (!arquivo) {
            alert('Selecione um arquivo para importar');
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            if (dados.length === 0) {
              alert('Nenhum dado encontrado no arquivo');
              return;
            }

            const dadosNormalizados = normalizarDados(dados);
            const token = localStorage.getItem('oursales:auth-token');

            if (!token) {
              // Importa√ß√£o local
              const storage = {
                load: () => {
                  const data = localStorage.getItem('oursales:data');
                  return data ? JSON.parse(data) : { faturamentos: [], parcelas: [] };
                },
                save: (data) => {
                  localStorage.setItem('oursales:data', JSON.stringify(data));
                },
              };

              const data = storage.load();
              if (!data.parcelas) {
                data.parcelas = [];
              }

              let importados = 0;
              dadosNormalizados.forEach((parcela) => {
                const novaParcela = {
                  id: `parc-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                  clienteCnpjCpf: parcela.clienteCnpjCpf || '',
                  industriaCnpj: parcela.industriaCnpj || '',
                  notaFiscal: parcela.notaFiscal,
                  dataFatura: parcela.dataFatura,
                  dataLiquidez: parcela.dataLiquidez,
                  valorParcela: parseFloat(parcela.valorParcela.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0,
                  valorComissao: parseFloat(parcela.valorComissao.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0,
                  comissaoPedido: parseFloat(parcela.comissaoPedido) || 0,
                  baseCalculo: parcela.baseCalculo || '',
                  ordemCompra: parcela.ordemCompra || '',
                  pedidoIndustria: parcela.pedidoIndustria || '',
                  pedidoOurSales: parcela.pedidoOurSales || '',
                  dataRecebimentoComissao: parcela.dataRecebimentoComissao || new Date().toISOString().split('T')[0],
                  emailVendedor: parcela.emailVendedor || '',
                  tipo: 'Faturamento',
                  criadoEm: new Date().toISOString(),
                };
                data.parcelas.push(novaParcela);
                importados++;
              });

              storage.save(data);
              alert(`${importados} parcela(s) importada(s) com sucesso!`);
              window.location.reload();
            } else {
              // Importa√ß√£o via API
              const response = await fetch(`${API_BASE}/faturamento/importar`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({
                  dados: dadosNormalizados,
                }),
              });

              const result = await response.json();

              if (response.ok) {
                alert(`${result.importados || dadosNormalizados.length} parcela(s) importada(s) com sucesso!`);
                window.location.reload();
              } else {
                alert(`Erro na importa√ß√£o: ${result.message || 'Erro desconhecido'}`);
              }
            }
          } catch (error) {
            alert(`Erro ao processar arquivo: ${error.message}`);
          }
        });
      }

      // Fun√ß√£o para inicializar importa√ß√£o de formas de pagamento
      function initImportarFormasPagamento() {
        const API_BASE = 'http://localhost:3000/api';
        const downloadBtnTop = document.getElementById('downloadTemplateExcelFormasPagamento');
        const downloadBtnBottom = document.getElementById('downloadTemplateExcelFormasPagamentoBottom');
        const importForm = document.getElementById('importFormFormasPagamento');
        const arquivoInput = document.getElementById('arquivoInputFormasPagamento');

        if (!downloadBtnTop || !downloadBtnBottom || !importForm || !arquivoInput) {
          return;
        }

        // Mapeamento de campos
        const camposMap = {
          cnpj: {
            header: 'CNPJ',
            checkboxId: 'checkboxCNPJFormasPagamento',
            obrigatorio: true,
          },
          descricao: {
            header: 'Descri√ß√£o',
            checkboxId: 'checkboxDescricaoFormasPagamento',
            obrigatorio: true,
          },
          quantidadeParcelas: {
            header: 'Quantidade de Parcelas',
            checkboxId: 'checkboxQuantidadeParcelas',
            obrigatorio: true,
          },
          intervaloDias: {
            header: 'Intervalo de dias',
            checkboxId: 'checkboxIntervaloDias',
            obrigatorio: true,
          },
          desconto: {
            header: 'Desconto',
            checkboxId: null,
            obrigatorio: false,
          },
          pedidoMinimo: {
            header: 'Pedido M√≠nimo',
            checkboxId: null,
            obrigatorio: false,
          },
        };

        // Obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll('#importar-formas-pagamento-content .field-checkbox');
          const fieldNames = document.querySelectorAll('#importar-formas-pagamento-content .field-name');

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(
                  (key) => camposMap[key].header === fieldName
                );
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === 'undefined') {
            alert('Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.');
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map((key) => camposMap[key].header);
          const dados = [headers];

          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 25 }));
          worksheet['!cols'] = colWidths;

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Formas de Pagamento');
          XLSX.writeFile(workbook, 'modelo_importacao_formas_pagamento.xlsx');
        }

        // Processar arquivo Excel
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || fileName.endsWith('.xlsm');

            if (!isExcel) {
              reject(new Error('Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos'));
              return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
              try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                if (jsonData.length < 2) {
                  reject(new Error('O arquivo est√° vazio ou n√£o possui dados'));
                  return;
                }

                const headers = jsonData[0].map((h) => String(h || '').trim());
                const dados = [];

                for (let i = 1; i < jsonData.length; i++) {
                  const linha = jsonData[i];
                  if (linha.every((cell) => !cell || String(cell).trim() === '')) continue;

                  const objeto = {};
                  headers.forEach((header, index) => {
                    const valor = linha[index];
                    objeto[header] = valor !== undefined && valor !== null ? String(valor).trim() : '';
                  });
                  dados.push(objeto);
                }

                resolve(dados);
              } catch (error) {
                reject(error);
              }
            };

            reader.onerror = function () {
              reject(new Error('Erro ao ler arquivo'));
            };

            reader.readAsArrayBuffer(arquivo);
          });
        }

        // Normalizar dados
        function normalizarDados(dados) {
          return dados.map((linha) => {
            const normalizado = {};
            
            // Normalizar CNPJ
            normalizado.cnpj = linha['CNPJ'] || linha['cnpj'] || '';
            
            // Normalizar descri√ß√£o
            normalizado.descricao = linha['Descri√ß√£o'] || linha['descricao'] || linha['Descricao'] || '';
            
            // Normalizar quantidade de parcelas
            normalizado.quantidadeParcelas = linha['Quantidade de Parcelas'] || linha['quantidadeParcelas'] || linha['QuantidadeParcelas'] || '';
            
            // Normalizar intervalo de dias
            normalizado.intervaloDias = linha['Intervalo de dias'] || linha['intervaloDias'] || linha['IntervaloDias'] || '';
            
            // Normalizar desconto
            normalizado.desconto = linha['Desconto'] || linha['desconto'] || '0';
            
            // Normalizar pedido m√≠nimo
            normalizado.pedidoMinimo = linha['Pedido M√≠nimo'] || linha['pedidoMinimo'] || linha['PedidoMinimo'] || '0';

            return normalizado;
          });
        }

        // Event listeners
        downloadBtnTop?.addEventListener('click', downloadTemplateExcel);
        downloadBtnBottom?.addEventListener('click', downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm?.addEventListener('submit', async function (e) {
          e.preventDefault();

          const arquivo = arquivoInput.files[0];
          if (!arquivo) {
            alert('Selecione um arquivo para importar');
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            if (dados.length === 0) {
              alert('Nenhum dado encontrado no arquivo');
              return;
            }

            const dadosNormalizados = normalizarDados(dados);
            const token = localStorage.getItem('oursales:auth-token');

            if (!token) {
              // Importa√ß√£o local
              const storage = {
                load: () => {
                  const data = localStorage.getItem('oursales:data');
                  return data ? JSON.parse(data) : { formasPagamento: [] };
                },
                save: (data) => {
                  localStorage.setItem('oursales:data', JSON.stringify(data));
                },
              };

              const data = storage.load();
              if (!data.formasPagamento) {
                data.formasPagamento = [];
              }

              let importados = 0;
              dadosNormalizados.forEach((formaPagamento) => {
                const novaFormaPagamento = {
                  id: `fp-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                  cnpj: formaPagamento.cnpj,
                  descricao: formaPagamento.descricao,
                  quantidadeParcelas: parseInt(formaPagamento.quantidadeParcelas) || 1,
                  intervaloDias: parseInt(formaPagamento.intervaloDias) || 0,
                  desconto: parseFloat(formaPagamento.desconto) || 0,
                  pedidoMinimo: parseFloat(formaPagamento.pedidoMinimo.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0,
                  criadoEm: new Date().toISOString(),
                };
                data.formasPagamento.push(novaFormaPagamento);
                importados++;
              });

              storage.save(data);
              alert(`${importados} forma(s) de pagamento importada(s) com sucesso!`);
              window.location.reload();
            } else {
              // Importa√ß√£o via API
              const response = await fetch(`${API_BASE}/formas-pagamento/importar`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({
                  dados: dadosNormalizados,
                }),
              });

              const result = await response.json();

              if (response.ok) {
                alert(`${result.importados || dadosNormalizados.length} forma(s) de pagamento importada(s) com sucesso!`);
                window.location.reload();
              } else {
                alert(`Erro na importa√ß√£o: ${result.message || 'Erro desconhecido'}`);
              }
            }
          } catch (error) {
            alert(`Erro ao processar arquivo: ${error.message}`);
          }
        });
      }

      // Fun√ß√£o para inicializar importa√ß√£o de transportadoras
      function initImportarTransportadoras() {
        const API_BASE = 'http://localhost:3000/api';
        const downloadBtnTop = document.getElementById('downloadTemplateExcelTransportadoras');
        const downloadBtnBottom = document.getElementById('downloadTemplateExcelTransportadorasBottom');
        const importForm = document.getElementById('importFormTransportadoras');
        const arquivoInput = document.getElementById('arquivoInputTransportadoras');

        if (!downloadBtnTop || !downloadBtnBottom || !importForm || !arquivoInput) {
          return;
        }

        // Mapeamento de campos
        const camposMap = {
          razaoSocial: {
            header: 'Raz√£o Social',
            checkboxId: 'checkboxRazaoSocialTransportadora',
            obrigatorio: true,
          },
          nomeFantasia: {
            header: 'Nome Fantasia',
            checkboxId: 'checkboxNomeFantasiaTransportadora',
            obrigatorio: true,
          },
          cnpj: {
            header: 'CNPJ',
            checkboxId: 'checkboxCNPJTransportadora',
            obrigatorio: true,
          },
          inscricaoEstadual: {
            header: 'Inscri√ß√£o Estadual',
            checkboxId: 'checkboxInscricaoEstadualTransportadora',
            obrigatorio: true,
          },
          inscricaoMunicipal: {
            header: 'Inscri√ß√£o Municipal',
            checkboxId: null,
            obrigatorio: false,
          },
          endereco: {
            header: 'Endere√ßo',
            checkboxId: 'checkboxEnderecoTransportadora',
            obrigatorio: true,
          },
          complemento: {
            header: 'Complemento',
            checkboxId: null,
            obrigatorio: false,
          },
          bairro: {
            header: 'Bairro',
            checkboxId: 'checkboxBairroTransportadora',
            obrigatorio: true,
          },
          cep: {
            header: 'CEP',
            checkboxId: 'checkboxCEPTransportadora',
            obrigatorio: true,
          },
          numero: {
            header: 'N√∫mero',
            checkboxId: 'checkboxNumeroTransportadora',
            obrigatorio: true,
          },
          cidade: {
            header: 'Cidade',
            checkboxId: 'checkboxCidadeTransportadora',
            obrigatorio: true,
          },
          estado: {
            header: 'Estado',
            checkboxId: 'checkboxEstadoTransportadora',
            obrigatorio: true,
          },
          telefone: {
            header: 'Telefone',
            checkboxId: 'checkboxTelefoneTransportadora',
            obrigatorio: true,
          },
          telefoneFax: {
            header: 'Telefone/Fax',
            checkboxId: null,
            obrigatorio: false,
          },
          email: {
            header: 'E-mail',
            checkboxId: null,
            obrigatorio: false,
          },
          website: {
            header: 'Website',
            checkboxId: null,
            obrigatorio: false,
          },
          contato: {
            header: 'Contato',
            checkboxId: null,
            obrigatorio: false,
          },
          aniversario: {
            header: 'Anivers√°rio',
            checkboxId: null,
            obrigatorio: false,
          },
          observacoes: {
            header: 'Observa√ß√µes',
            checkboxId: null,
            obrigatorio: false,
          },
        };

        // Obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll('#importar-transportadoras-content .field-checkbox');
          const fieldNames = document.querySelectorAll('#importar-transportadoras-content .field-name');

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(
                  (key) => camposMap[key].header === fieldName
                );
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === 'undefined') {
            alert('Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.');
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map((key) => camposMap[key].header);
          const dados = [headers];

          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 25 }));
          worksheet['!cols'] = colWidths;

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Transportadoras');
          XLSX.writeFile(workbook, 'modelo_importacao_transportadoras.xlsx');
        }

        // Processar arquivo Excel
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || fileName.endsWith('.xlsm');

            if (!isExcel) {
              reject(new Error('Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos'));
              return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
              try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                if (jsonData.length < 2) {
                  reject(new Error('O arquivo est√° vazio ou n√£o possui dados'));
                  return;
                }

                const headers = jsonData[0].map((h) => String(h || '').trim());
                const dados = [];

                for (let i = 1; i < jsonData.length; i++) {
                  const linha = jsonData[i];
                  if (linha.every((cell) => !cell || String(cell).trim() === '')) continue;

                  const objeto = {};
                  headers.forEach((header, index) => {
                    const valor = linha[index];
                    objeto[header] = valor !== undefined && valor !== null ? String(valor).trim() : '';
                  });
                  dados.push(objeto);
                }

                resolve(dados);
              } catch (error) {
                reject(error);
              }
            };

            reader.onerror = function () {
              reject(new Error('Erro ao ler arquivo'));
            };

            reader.readAsArrayBuffer(arquivo);
          });
        }

        // Normalizar dados
        function normalizarDados(dados) {
          return dados.map((linha) => {
            const normalizado = {};
            
            // Normalizar raz√£o social
            normalizado.razaoSocial = linha['Raz√£o Social'] || linha['razaoSocial'] || linha['RazaoSocial'] || '';
            
            // Normalizar nome fantasia
            normalizado.nomeFantasia = linha['Nome Fantasia'] || linha['nomeFantasia'] || linha['NomeFantasia'] || '';
            
            // Normalizar CNPJ
            normalizado.cnpj = linha['CNPJ'] || linha['cnpj'] || '';
            
            // Normalizar inscri√ß√£o estadual
            normalizado.inscricaoEstadual = linha['Inscri√ß√£o Estadual'] || linha['inscricaoEstadual'] || linha['InscricaoEstadual'] || '';
            
            // Normalizar inscri√ß√£o municipal
            normalizado.inscricaoMunicipal = linha['Inscri√ß√£o Municipal'] || linha['inscricaoMunicipal'] || linha['InscricaoMunicipal'] || '';
            
            // Normalizar endere√ßo
            normalizado.endereco = linha['Endere√ßo'] || linha['endereco'] || linha['Endereco'] || '';
            
            // Normalizar complemento
            normalizado.complemento = linha['Complemento'] || linha['complemento'] || '';
            
            // Normalizar bairro
            normalizado.bairro = linha['Bairro'] || linha['bairro'] || '';
            
            // Normalizar CEP
            normalizado.cep = linha['CEP'] || linha['cep'] || '';
            
            // Normalizar n√∫mero
            normalizado.numero = linha['N√∫mero'] || linha['numero'] || linha['Numero'] || '';
            
            // Normalizar cidade
            normalizado.cidade = linha['Cidade'] || linha['cidade'] || '';
            
            // Normalizar estado
            normalizado.estado = linha['Estado'] || linha['estado'] || '';
            
            // Normalizar telefone
            normalizado.telefone = linha['Telefone'] || linha['telefone'] || '';
            
            // Normalizar telefone/fax
            normalizado.telefoneFax = linha['Telefone/Fax'] || linha['telefoneFax'] || linha['TelefoneFax'] || '';
            
            // Normalizar e-mail
            normalizado.email = linha['E-mail'] || linha['email'] || linha['Email'] || '';
            
            // Normalizar website
            normalizado.website = linha['Website'] || linha['website'] || '';
            
            // Normalizar contato
            normalizado.contato = linha['Contato'] || linha['contato'] || '';
            
            // Normalizar anivers√°rio
            normalizado.aniversario = linha['Anivers√°rio'] || linha['aniversario'] || linha['Aniversario'] || '';
            
            // Normalizar observa√ß√µes
            normalizado.observacoes = linha['Observa√ß√µes'] || linha['observacoes'] || linha['Observacoes'] || '';

            return normalizado;
          });
        }

        // Event listeners
        downloadBtnTop?.addEventListener('click', downloadTemplateExcel);
        downloadBtnBottom?.addEventListener('click', downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm?.addEventListener('submit', async function (e) {
          e.preventDefault();

          const arquivo = arquivoInput.files[0];
          if (!arquivo) {
            alert('Selecione um arquivo para importar');
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            if (dados.length === 0) {
              alert('Nenhum dado encontrado no arquivo');
              return;
            }

            const dadosNormalizados = normalizarDados(dados);
            const token = localStorage.getItem('oursales:auth-token');

            if (!token) {
              // Importa√ß√£o local
              const storage = {
                load: () => {
                  const data = localStorage.getItem('oursales:data');
                  return data ? JSON.parse(data) : { transportadoras: [] };
                },
                save: (data) => {
                  localStorage.setItem('oursales:data', JSON.stringify(data));
                },
              };

              const data = storage.load();
              if (!data.transportadoras) {
                data.transportadoras = [];
              }

              let importados = 0;
              dadosNormalizados.forEach((transportadora) => {
                // Verificar se j√° existe transportadora com mesmo CNPJ
                const existe = data.transportadoras.find(
                  (t) => t.cnpj === transportadora.cnpj
                );

                if (!existe) {
                  const novaTransportadora = {
                    id: `transp-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                    razaoSocial: transportadora.razaoSocial,
                    nomeFantasia: transportadora.nomeFantasia,
                    cnpj: transportadora.cnpj,
                    inscricaoEstadual: transportadora.inscricaoEstadual,
                    inscricaoMunicipal: transportadora.inscricaoMunicipal || '',
                    endereco: transportadora.endereco,
                    complemento: transportadora.complemento || '',
                    bairro: transportadora.bairro,
                    cep: transportadora.cep,
                    numero: transportadora.numero,
                    cidade: transportadora.cidade,
                    estado: transportadora.estado,
                    telefone: transportadora.telefone,
                    telefoneFax: transportadora.telefoneFax || '',
                    email: transportadora.email || '',
                    website: transportadora.website || '',
                    contato: transportadora.contato || '',
                    aniversario: transportadora.aniversario || '',
                    observacoes: transportadora.observacoes || '',
                    ativo: true,
                    criadoEm: new Date().toISOString(),
                  };
                  data.transportadoras.push(novaTransportadora);
                  importados++;
                }
              });

              storage.save(data);
              alert(`${importados} transportadora(s) importada(s) com sucesso!`);
              window.location.reload();
            } else {
              // Importa√ß√£o via API
              const response = await fetch(`${API_BASE}/transportadoras/importar`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({
                  dados: dadosNormalizados,
                }),
              });

              const result = await response.json();

              if (response.ok) {
                alert(`${result.importados || dadosNormalizados.length} transportadora(s) importada(s) com sucesso!`);
                window.location.reload();
              } else {
                alert(`Erro na importa√ß√£o: ${result.message || 'Erro desconhecido'}`);
              }
            }
          } catch (error) {
            alert(`Erro ao processar arquivo: ${error.message}`);
          }
        });
      }

      // Fun√ß√£o para inicializar importa√ß√£o de pedido r√°pido
      function initImportarPedidoRapido() {
        const API_BASE = 'http://localhost:3000/api';
        const downloadBtnTop = document.getElementById('downloadTemplateExcelPedidoRapido');
        const downloadBtnBottom = document.getElementById('downloadTemplateExcelPedidoRapidoBottom');
        const importForm = document.getElementById('importFormPedidoRapido');
        const arquivoInput = document.getElementById('arquivoInputPedidoRapido');

        if (!downloadBtnTop || !downloadBtnBottom || !importForm || !arquivoInput) {
          return;
        }

        // Mapeamento de campos
        const camposMap = {
          clienteCnpjCpf: {
            header: 'Cliente - CNPJ/CPF',
            checkboxId: null,
            obrigatorio: false,
          },
          clienteCodigo: {
            header: 'Cliente - C√≥digo',
            checkboxId: null,
            obrigatorio: false,
          },
          clienteRazaoSocial: {
            header: 'Cliente - Raz√£o Social',
            checkboxId: null,
            obrigatorio: false,
          },
          clienteNomeFantasia: {
            header: 'Cliente - Nome Fantasia',
            checkboxId: null,
            obrigatorio: false,
          },
          clienteEmail: {
            header: 'Cliente - E-mail',
            checkboxId: null,
            obrigatorio: false,
          },
          industriaCnpj: {
            header: 'Ind√∫stria - CNPJ',
            checkboxId: null,
            obrigatorio: false,
          },
          industriaRazaoSocial: {
            header: 'Ind√∫stria - Raz√£o Social',
            checkboxId: null,
            obrigatorio: false,
          },
          industriaNomeFantasia: {
            header: 'Ind√∫stria - Nome Fantasia',
            checkboxId: null,
            obrigatorio: false,
          },
          vendedorNome: {
            header: 'Vendedor - Nome',
            checkboxId: null,
            obrigatorio: false,
          },
          vendedorEmail: {
            header: 'Vendedor - E-mail',
            checkboxId: null,
            obrigatorio: false,
          },
          valor: {
            header: 'Valor',
            checkboxId: null,
            obrigatorio: false,
          },
          dataVenda: {
            header: 'Data Venda',
            checkboxId: null,
            obrigatorio: false,
          },
          numeroIndustria: {
            header: 'N√∫mero na Ind√∫stria',
            checkboxId: null,
            obrigatorio: false,
          },
          ordemCompra: {
            header: 'Ordem de Compra',
            checkboxId: null,
            obrigatorio: false,
          },
          quantidadeItens: {
            header: 'Quantidade de Itens',
            checkboxId: null,
            obrigatorio: false,
          },
          condicaoPagamento: {
            header: 'Condi√ß√£o de Pagamento',
            checkboxId: null,
            obrigatorio: false,
          },
          dataFatura: {
            header: 'Data de Fatura',
            checkboxId: null,
            obrigatorio: false,
          },
          dataEntrega: {
            header: 'Data de Entrega',
            checkboxId: null,
            obrigatorio: false,
          },
          enderecoCobranca: {
            header: 'Endere√ßo de Cobran√ßa',
            checkboxId: null,
            obrigatorio: false,
          },
          enderecoEntrega: {
            header: 'Endere√ßo de Entrega',
            checkboxId: null,
            obrigatorio: false,
          },
          numeroTalao: {
            header: 'N√∫mero do Tal√£o',
            checkboxId: null,
            obrigatorio: false,
          },
          frete: {
            header: 'Frete',
            checkboxId: null,
            obrigatorio: false,
          },
          valorFrete: {
            header: 'Valor do Frete',
            checkboxId: null,
            obrigatorio: false,
          },
          transportadoraCnpj: {
            header: 'Transportadora - CNPJ',
            checkboxId: null,
            obrigatorio: false,
          },
          transportadoraRazaoSocial: {
            header: 'Transportadora - Raz√£o Social',
            checkboxId: null,
            obrigatorio: false,
          },
          transportadoraNomeFantasia: {
            header: 'Transportadora - Nome Fantasia',
            checkboxId: null,
            obrigatorio: false,
          },
          transportadoraEmail: {
            header: 'Transportadora - E-mail',
            checkboxId: null,
            obrigatorio: false,
          },
          compradorNome: {
            header: 'Comprador - Nome',
            checkboxId: null,
            obrigatorio: false,
          },
          compradorEmail: {
            header: 'Comprador - E-mail',
            checkboxId: null,
            obrigatorio: false,
          },
          comissaoPercentual: {
            header: 'Comiss√£o %',
            checkboxId: null,
            obrigatorio: false,
          },
          tipo: {
            header: 'Tipo',
            checkboxId: null,
            obrigatorio: false,
          },
          notaFiscal: {
            header: 'Nota Fiscal',
            checkboxId: null,
            obrigatorio: false,
          },
          statusPedido: {
            header: 'Status do Pedido',
            checkboxId: null,
            obrigatorio: false,
          },
          observacao: {
            header: 'Observa√ß√£o',
            checkboxId: null,
            obrigatorio: false,
          },
        };

        // Obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll('#importar-pedido-rapido-content .field-checkbox');
          const fieldNames = document.querySelectorAll('#importar-pedido-rapido-content .field-name');

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(
                  (key) => camposMap[key].header === fieldName
                );
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === 'undefined') {
            alert('Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.');
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map((key) => camposMap[key].header);
          const dados = [headers];

          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 25 }));
          worksheet['!cols'] = colWidths;

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Pedidos R√°pidos');
          XLSX.writeFile(workbook, 'modelo_importacao_pedido_rapido.xlsx');
        }

        // Processar arquivo Excel
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || fileName.endsWith('.xlsm');

            if (!isExcel) {
              reject(new Error('Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos'));
              return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
              try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                if (jsonData.length < 2) {
                  reject(new Error('O arquivo est√° vazio ou n√£o possui dados'));
                  return;
                }

                const headers = jsonData[0].map((h) => String(h || '').trim());
                const dados = [];

                for (let i = 1; i < jsonData.length; i++) {
                  const linha = jsonData[i];
                  if (linha.every((cell) => !cell || String(cell).trim() === '')) continue;

                  const objeto = {};
                  headers.forEach((header, index) => {
                    const valor = linha[index];
                    objeto[header] = valor !== undefined && valor !== null ? String(valor).trim() : '';
                  });
                  dados.push(objeto);
                }

                resolve(dados);
              } catch (error) {
                reject(error);
              }
            };

            reader.onerror = function () {
              reject(new Error('Erro ao ler arquivo'));
            };

            reader.readAsArrayBuffer(arquivo);
          });
        }

        // Normalizar dados
        function normalizarDados(dados) {
          return dados.map((linha) => {
            const normalizado = {};
            
            // Normalizar cliente CNPJ/CPF
            normalizado.clienteCnpjCpf = linha['Cliente - CNPJ/CPF'] || linha['clienteCnpjCpf'] || linha['Cliente CNPJ/CPF'] || '';
            
            // Normalizar cliente c√≥digo
            normalizado.clienteCodigo = linha['Cliente - C√≥digo'] || linha['clienteCodigo'] || linha['Cliente Codigo'] || '';
            
            // Normalizar cliente raz√£o social
            normalizado.clienteRazaoSocial = linha['Cliente - Raz√£o Social'] || linha['clienteRazaoSocial'] || linha['Cliente RazaoSocial'] || '';
            
            // Normalizar cliente nome fantasia
            normalizado.clienteNomeFantasia = linha['Cliente - Nome Fantasia'] || linha['clienteNomeFantasia'] || linha['Cliente NomeFantasia'] || '';
            
            // Normalizar cliente e-mail
            normalizado.clienteEmail = linha['Cliente - E-mail'] || linha['clienteEmail'] || linha['Cliente Email'] || '';
            
            // Normalizar ind√∫stria CNPJ
            normalizado.industriaCnpj = linha['Ind√∫stria - CNPJ'] || linha['industriaCnpj'] || linha['Industria CNPJ'] || '';
            
            // Normalizar ind√∫stria raz√£o social
            normalizado.industriaRazaoSocial = linha['Ind√∫stria - Raz√£o Social'] || linha['industriaRazaoSocial'] || linha['Industria RazaoSocial'] || '';
            
            // Normalizar ind√∫stria nome fantasia
            normalizado.industriaNomeFantasia = linha['Ind√∫stria - Nome Fantasia'] || linha['industriaNomeFantasia'] || linha['Industria NomeFantasia'] || '';
            
            // Normalizar vendedor nome
            normalizado.vendedorNome = linha['Vendedor - Nome'] || linha['vendedorNome'] || linha['Vendedor Nome'] || '';
            
            // Normalizar vendedor e-mail
            normalizado.vendedorEmail = linha['Vendedor - E-mail'] || linha['vendedorEmail'] || linha['Vendedor Email'] || '';
            
            // Normalizar valor
            normalizado.valor = linha['Valor'] || linha['valor'] || '0';
            
            // Normalizar data venda
            normalizado.dataVenda = linha['Data Venda'] || linha['dataVenda'] || linha['DataVenda'] || '';
            
            // Normalizar n√∫mero na ind√∫stria
            normalizado.numeroIndustria = linha['N√∫mero na Ind√∫stria'] || linha['numeroIndustria'] || linha['NumeroIndustria'] || '';
            
            // Normalizar ordem de compra
            normalizado.ordemCompra = linha['Ordem de Compra'] || linha['ordemCompra'] || linha['OrdemCompra'] || '';
            
            // Normalizar quantidade de itens
            normalizado.quantidadeItens = linha['Quantidade de Itens'] || linha['quantidadeItens'] || linha['QuantidadeItens'] || '0';
            
            // Normalizar condi√ß√£o de pagamento
            normalizado.condicaoPagamento = linha['Condi√ß√£o de Pagamento'] || linha['condicaoPagamento'] || linha['CondicaoPagamento'] || '';
            
            // Normalizar data de fatura
            normalizado.dataFatura = linha['Data de Fatura'] || linha['dataFatura'] || linha['DataFatura'] || '';
            
            // Normalizar data de entrega
            normalizado.dataEntrega = linha['Data de Entrega'] || linha['dataEntrega'] || linha['DataEntrega'] || '';
            
            // Normalizar endere√ßo de cobran√ßa
            normalizado.enderecoCobranca = linha['Endere√ßo de Cobran√ßa'] || linha['enderecoCobranca'] || linha['EnderecoCobranca'] || '';
            
            // Normalizar endere√ßo de entrega
            normalizado.enderecoEntrega = linha['Endere√ßo de Entrega'] || linha['enderecoEntrega'] || linha['EnderecoEntrega'] || '';
            
            // Normalizar n√∫mero do tal√£o
            normalizado.numeroTalao = linha['N√∫mero do Tal√£o'] || linha['numeroTalao'] || linha['NumeroTalao'] || '';
            
            // Normalizar frete
            normalizado.frete = linha['Frete'] || linha['frete'] || '';
            
            // Normalizar valor do frete
            normalizado.valorFrete = linha['Valor do Frete'] || linha['valorFrete'] || linha['ValorFrete'] || '0';
            
            // Normalizar transportadora CNPJ
            normalizado.transportadoraCnpj = linha['Transportadora - CNPJ'] || linha['transportadoraCnpj'] || linha['Transportadora CNPJ'] || '';
            
            // Normalizar transportadora raz√£o social
            normalizado.transportadoraRazaoSocial = linha['Transportadora - Raz√£o Social'] || linha['transportadoraRazaoSocial'] || linha['Transportadora RazaoSocial'] || '';
            
            // Normalizar transportadora nome fantasia
            normalizado.transportadoraNomeFantasia = linha['Transportadora - Nome Fantasia'] || linha['transportadoraNomeFantasia'] || linha['Transportadora NomeFantasia'] || '';
            
            // Normalizar transportadora e-mail
            normalizado.transportadoraEmail = linha['Transportadora - E-mail'] || linha['transportadoraEmail'] || linha['Transportadora Email'] || '';
            
            // Normalizar comprador nome
            normalizado.compradorNome = linha['Comprador - Nome'] || linha['compradorNome'] || linha['Comprador Nome'] || '';
            
            // Normalizar comprador e-mail
            normalizado.compradorEmail = linha['Comprador - E-mail'] || linha['compradorEmail'] || linha['Comprador Email'] || '';
            
            // Normalizar comiss√£o percentual
            normalizado.comissaoPercentual = linha['Comiss√£o %'] || linha['comissaoPercentual'] || linha['Comissao'] || '0';
            
            // Normalizar tipo
            normalizado.tipo = linha['Tipo'] || linha['tipo'] || '';
            
            // Normalizar nota fiscal
            normalizado.notaFiscal = linha['Nota Fiscal'] || linha['notaFiscal'] || linha['NotaFiscal'] || '';
            
            // Normalizar status do pedido
            normalizado.statusPedido = linha['Status do Pedido'] || linha['statusPedido'] || linha['StatusPedido'] || '';
            
            // Normalizar observa√ß√£o
            normalizado.observacao = linha['Observa√ß√£o'] || linha['observacao'] || linha['Observacao'] || '';

            return normalizado;
          });
        }

        // Event listeners
        downloadBtnTop?.addEventListener('click', downloadTemplateExcel);
        downloadBtnBottom?.addEventListener('click', downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm?.addEventListener('submit', async function (e) {
          e.preventDefault();

          const arquivo = arquivoInput.files[0];
          if (!arquivo) {
            alert('Selecione um arquivo para importar');
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            if (dados.length === 0) {
              alert('Nenhum dado encontrado no arquivo');
              return;
            }

            const dadosNormalizados = normalizarDados(dados);
            const token = localStorage.getItem('oursales:auth-token');

            if (!token) {
              // Importa√ß√£o local
              const storage = {
                load: () => {
                  const data = localStorage.getItem('oursales:data');
                  return data ? JSON.parse(data) : { pedidos: [] };
                },
                save: (data) => {
                  localStorage.setItem('oursales:data', JSON.stringify(data));
                },
              };

              const data = storage.load();
              if (!data.pedidos) {
                data.pedidos = [];
              }

              let importados = 0;
              dadosNormalizados.forEach((pedido) => {
                const novoPedido = {
                  id: `ped-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                  clienteCnpjCpf: pedido.clienteCnpjCpf || '',
                  clienteCodigo: pedido.clienteCodigo || '',
                  clienteRazaoSocial: pedido.clienteRazaoSocial || '',
                  clienteNomeFantasia: pedido.clienteNomeFantasia || '',
                  clienteEmail: pedido.clienteEmail || '',
                  industriaCnpj: pedido.industriaCnpj || '',
                  industriaRazaoSocial: pedido.industriaRazaoSocial || '',
                  industriaNomeFantasia: pedido.industriaNomeFantasia || '',
                  vendedorNome: pedido.vendedorNome || '',
                  vendedorEmail: pedido.vendedorEmail || '',
                  valor: parseFloat(pedido.valor.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0,
                  dataVenda: pedido.dataVenda || '',
                  numeroIndustria: pedido.numeroIndustria || '',
                  ordemCompra: pedido.ordemCompra || '',
                  quantidadeItens: parseInt(pedido.quantidadeItens) || 0,
                  condicaoPagamento: pedido.condicaoPagamento || '',
                  dataFatura: pedido.dataFatura || '',
                  dataEntrega: pedido.dataEntrega || '',
                  enderecoCobranca: pedido.enderecoCobranca || '',
                  enderecoEntrega: pedido.enderecoEntrega || '',
                  numeroTalao: pedido.numeroTalao || '',
                  frete: pedido.frete || '',
                  valorFrete: parseFloat(pedido.valorFrete.replace(/[^\d,.-]/g, '').replace(',', '.')) || 0,
                  transportadoraCnpj: pedido.transportadoraCnpj || '',
                  transportadoraRazaoSocial: pedido.transportadoraRazaoSocial || '',
                  transportadoraNomeFantasia: pedido.transportadoraNomeFantasia || '',
                  transportadoraEmail: pedido.transportadoraEmail || '',
                  compradorNome: pedido.compradorNome || '',
                  compradorEmail: pedido.compradorEmail || '',
                  comissaoPercentual: parseFloat(pedido.comissaoPercentual) || 0,
                  tipo: pedido.tipo || 'Pedido R√°pido',
                  notaFiscal: pedido.notaFiscal || '',
                  statusPedido: pedido.statusPedido || 'pendente',
                  observacao: pedido.observacao || '',
                  criadoEm: new Date().toISOString(),
                };
                data.pedidos.push(novoPedido);
                importados++;
              });

              storage.save(data);
              alert(`${importados} pedido(s) importado(s) com sucesso!`);
              window.location.reload();
            } else {
              // Importa√ß√£o via API
              const response = await fetch(`${API_BASE}/pedidos/importar-rapido`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({
                  dados: dadosNormalizados,
                }),
              });

              const result = await response.json();

              if (response.ok) {
                alert(`${result.importados || dadosNormalizados.length} pedido(s) importado(s) com sucesso!`);
                window.location.reload();
              } else {
                alert(`Erro na importa√ß√£o: ${result.message || 'Erro desconhecido'}`);
              }
            }
          } catch (error) {
            alert(`Erro ao processar arquivo: ${error.message}`);
          }
        });
      }

      // Fun√ß√£o para inicializar importa√ß√£o de grupo de conta
      function initImportarGrupoConta() {
        const API_BASE = 'http://localhost:3000/api';
        const downloadBtnTop = document.getElementById('downloadTemplateExcelGrupoConta');
        const downloadBtnBottom = document.getElementById('downloadTemplateExcelGrupoContaBottom');
        const importForm = document.getElementById('importFormGrupoConta');
        const arquivoInput = document.getElementById('arquivoInputGrupoConta');

        if (!downloadBtnTop || !downloadBtnBottom || !importForm || !arquivoInput) {
          return;
        }

        // Mapeamento de campos
        const camposMap = {
          codigo: {
            header: 'C√≥digo',
            checkboxId: null,
            obrigatorio: false,
          },
          descricao: {
            header: 'Descri√ß√£o',
            checkboxId: null,
            obrigatorio: false,
          },
          tipo: {
            header: 'Tipo',
            checkboxId: null,
            obrigatorio: false,
          },
          codigoClassificacao: {
            header: 'C√≥digo de Classifica√ß√£o',
            checkboxId: null,
            obrigatorio: false,
          },
          codigoGrupoPrincipal: {
            header: 'C√≥digo do Grupo Principal',
            checkboxId: null,
            obrigatorio: false,
          },
        };

        // Obter campos selecionados
        function obterCamposSelecionados() {
          const camposSelecionados = [];
          const checkboxes = document.querySelectorAll('#importar-grupo-conta-content .field-checkbox');
          const fieldNames = document.querySelectorAll('#importar-grupo-conta-content .field-name');

          checkboxes.forEach((checkbox, index) => {
            if (checkbox.checked && !checkbox.disabled) {
              const fieldName = fieldNames[index]?.textContent.trim();
              if (fieldName) {
                const campoKey = Object.keys(camposMap).find(
                  (key) => camposMap[key].header === fieldName
                );
                if (campoKey) {
                  camposSelecionados.push(campoKey);
                }
              }
            }
          });

          return camposSelecionados;
        }

        // Download do template Excel
        function downloadTemplateExcel() {
          if (typeof XLSX === 'undefined') {
            alert('Biblioteca XLSX n√£o carregada. Por favor, recarregue a p√°gina.');
            return;
          }

          const camposSelecionados = obterCamposSelecionados();
          const headers = camposSelecionados.map((key) => camposMap[key].header);
          const dados = [headers];

          const worksheet = XLSX.utils.aoa_to_sheet(dados);
          const colWidths = headers.map(() => ({ wch: 30 }));
          worksheet['!cols'] = colWidths;

          const workbook = XLSX.utils.book_new();
          XLSX.utils.book_append_sheet(workbook, worksheet, 'Grupos de Conta');
          XLSX.writeFile(workbook, 'modelo_importacao_grupo_conta.xlsx');
        }

        // Processar arquivo Excel
        function processarArquivo(arquivo) {
          return new Promise((resolve, reject) => {
            const fileName = arquivo.name.toLowerCase();
            const isExcel = fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || fileName.endsWith('.xlsm');

            if (!isExcel) {
              reject(new Error('Apenas arquivos Excel (.xlsx, .xls) s√£o aceitos'));
              return;
            }

            const reader = new FileReader();
            reader.onload = function (e) {
              try {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

                if (jsonData.length < 2) {
                  reject(new Error('O arquivo est√° vazio ou n√£o possui dados'));
                  return;
                }

                const headers = jsonData[0].map((h) => String(h || '').trim());
                const dados = [];

                for (let i = 1; i < jsonData.length; i++) {
                  const linha = jsonData[i];
                  if (linha.every((cell) => !cell || String(cell).trim() === '')) continue;

                  const objeto = {};
                  headers.forEach((header, index) => {
                    const valor = linha[index];
                    objeto[header] = valor !== undefined && valor !== null ? String(valor).trim() : '';
                  });
                  dados.push(objeto);
                }

                resolve(dados);
              } catch (error) {
                reject(error);
              }
            };

            reader.onerror = function () {
              reject(new Error('Erro ao ler arquivo'));
            };

            reader.readAsArrayBuffer(arquivo);
          });
        }

        // Normalizar dados
        function normalizarDados(dados) {
          return dados.map((linha) => {
            const normalizado = {};
            
            // Normalizar c√≥digo
            normalizado.codigo = linha['C√≥digo'] || linha['codigo'] || linha['Codigo'] || '';
            
            // Normalizar descri√ß√£o
            normalizado.descricao = linha['Descri√ß√£o'] || linha['descricao'] || linha['Descricao'] || '';
            
            // Normalizar tipo (Receita ou Despesa)
            const tipoRaw = linha['Tipo'] || linha['tipo'] || linha['TIPO'] || '';
            normalizado.tipo = tipoRaw.toLowerCase().includes('receita') ? 'Receita' : 
                              tipoRaw.toLowerCase().includes('despesa') ? 'Despesa' : tipoRaw;
            
            // Normalizar c√≥digo de classifica√ß√£o
            normalizado.codigoClassificacao = linha['C√≥digo de Classifica√ß√£o'] || linha['codigoClassificacao'] || linha['CodigoClassificacao'] || linha['C√≥digo Classifica√ß√£o'] || '';
            
            // Normalizar c√≥digo do grupo principal
            normalizado.codigoGrupoPrincipal = linha['C√≥digo do Grupo Principal'] || linha['codigoGrupoPrincipal'] || linha['CodigoGrupoPrincipal'] || linha['C√≥digo Grupo Principal'] || '';

            return normalizado;
          });
        }

        // Event listeners
        downloadBtnTop?.addEventListener('click', downloadTemplateExcel);
        downloadBtnBottom?.addEventListener('click', downloadTemplateExcel);

        // Submiss√£o do formul√°rio
        importForm?.addEventListener('submit', async function (e) {
          e.preventDefault();

          const arquivo = arquivoInput.files[0];
          if (!arquivo) {
            alert('Selecione um arquivo para importar');
            return;
          }

          try {
            const dados = await processarArquivo(arquivo);
            if (dados.length === 0) {
              alert('Nenhum dado encontrado no arquivo');
              return;
            }

            const dadosNormalizados = normalizarDados(dados);
            const token = localStorage.getItem('oursales:auth-token');

            if (!token) {
              // Importa√ß√£o local
              const storage = {
                load: () => {
                  const data = localStorage.getItem('oursales:data');
                  return data ? JSON.parse(data) : { gruposConta: [] };
                },
                save: (data) => {
                  localStorage.setItem('oursales:data', JSON.stringify(data));
                },
              };

              const data = storage.load();
              if (!data.gruposConta) {
                data.gruposConta = [];
              }

              let importados = 0;
              let atualizados = 0;
              
              dadosNormalizados.forEach((grupoConta) => {
                // Se tiver c√≥digo, verifica se j√° existe para atualizar
                if (grupoConta.codigo) {
                  const existenteIndex = data.gruposConta.findIndex(
                    (gc) => gc.codigo === grupoConta.codigo
                  );
                  
                  if (existenteIndex >= 0) {
                    // Atualizar existente
                    data.gruposConta[existenteIndex] = {
                      ...data.gruposConta[existenteIndex],
                      descricao: grupoConta.descricao || data.gruposConta[existenteIndex].descricao,
                      tipo: grupoConta.tipo || data.gruposConta[existenteIndex].tipo,
                      codigoClassificacao: grupoConta.codigoClassificacao || data.gruposConta[existenteIndex].codigoClassificacao,
                      codigoGrupoPrincipal: grupoConta.codigoGrupoPrincipal || data.gruposConta[existenteIndex].codigoGrupoPrincipal,
                      atualizadoEm: new Date().toISOString(),
                    };
                    atualizados++;
                  } else {
                    // Criar novo
                    const novoGrupoConta = {
                      id: `gc-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                      codigo: grupoConta.codigo,
                      descricao: grupoConta.descricao || '',
                      tipo: grupoConta.tipo || 'Despesa',
                      codigoClassificacao: grupoConta.codigoClassificacao || '',
                      codigoGrupoPrincipal: grupoConta.codigoGrupoPrincipal || '',
                      ativo: true,
                      criadoEm: new Date().toISOString(),
                    };
                    data.gruposConta.push(novoGrupoConta);
                    importados++;
                  }
                } else {
                  // Criar novo sem c√≥digo
                  const novoGrupoConta = {
                    id: `gc-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                    codigo: '',
                    descricao: grupoConta.descricao || '',
                    tipo: grupoConta.tipo || 'Despesa',
                    codigoClassificacao: grupoConta.codigoClassificacao || '',
                    codigoGrupoPrincipal: grupoConta.codigoGrupoPrincipal || '',
                    ativo: true,
                    criadoEm: new Date().toISOString(),
                  };
                  data.gruposConta.push(novoGrupoConta);
                  importados++;
                }
              });

              storage.save(data);
              const mensagem = atualizados > 0 
                ? `${importados} grupo(s) de conta importado(s) e ${atualizados} atualizado(s) com sucesso!`
                : `${importados} grupo(s) de conta importado(s) com sucesso!`;
              alert(mensagem);
              window.location.reload();
            } else {
              // Importa√ß√£o via API
              const response = await fetch(`${API_BASE}/grupos-conta/importar`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify({
                  dados: dadosNormalizados,
                }),
              });

              const result = await response.json();

              if (response.ok) {
                const mensagem = result.atualizados > 0
                  ? `${result.importados || 0} grupo(s) de conta importado(s) e ${result.atualizados} atualizado(s) com sucesso!`
                  : `${result.importados || dadosNormalizados.length} grupo(s) de conta importado(s) com sucesso!`;
                alert(mensagem);
                window.location.reload();
              } else {
                alert(`Erro na importa√ß√£o: ${result.message || 'Erro desconhecido'}`);
              }
            }
          } catch (error) {
            alert(`Erro ao processar arquivo: ${error.message}`);
          }
        });
      }

      // Fun√ß√£o para inicializar dados cadastrais
      function initDadosCadastrais() {
        const API_BASE = 'http://localhost:3000/api';
        const form = document.getElementById('formDadosCadastrais');
        const subdominioInput = document.getElementById('subdominio');
        const subdominioStatus = document.getElementById('subdominioStatus');
        const cnpjInput = document.getElementById('cnpj');
        const cepInput = document.getElementById('cep');
        const telefoneInput = document.getElementById('telefone');
        const faxInput = document.getElementById('fax');

        if (!form) {
          return;
        }

        // M√°scaras de input
        if (cnpjInput) {
          cnpjInput.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 14) {
              value = value.replace(/^(\d{2})(\d)/, '$1.$2');
              value = value.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
              value = value.replace(/\.(\d{3})(\d)/, '.$1/$2');
              value = value.replace(/(\d{4})(\d)/, '$1-$2');
              e.target.value = value;
            }
          });
        }

        if (cepInput) {
          cepInput.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 8) {
              value = value.replace(/^(\d{5})(\d)/, '$1-$2');
              e.target.value = value;
            }
          });
        }

        if (telefoneInput) {
          telefoneInput.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
              if (value.length <= 10) {
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{4})(\d)/, '$1-$2');
              } else {
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
              }
              e.target.value = value;
            }
          });
        }

        if (faxInput) {
          faxInput.addEventListener('input', function (e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length <= 11) {
              if (value.length <= 10) {
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{4})(\d)/, '$1-$2');
              } else {
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
                value = value.replace(/(\d{5})(\d)/, '$1-$2');
              }
              e.target.value = value;
            }
          });
        }

        // Valida√ß√£o de subdom√≠nio
        let subdominioTimeout;
        if (subdominioInput && subdominioStatus) {
          subdominioInput.addEventListener('input', function (e) {
            const subdominio = e.target.value.trim().toLowerCase();
            
            // Limpar timeout anterior
            clearTimeout(subdominioTimeout);
            
            // Validar formato
            if (subdominio && !/^[a-z0-9-]+$/.test(subdominio)) {
              subdominioStatus.innerHTML = '<span style="color: #ef4444;"><i class="ti ti-alert-triangle"></i> Apenas letras min√∫sculas, n√∫meros e h√≠fens s√£o permitidos</span>';
              return;
            }

            if (subdominio.length < 3) {
              subdominioStatus.innerHTML = '<span style="color: #f59e0b;"><i class="ti ti-hourglass"></i> M√≠nimo de 3 caracteres</span>';
              return;
            }

            // Verificar disponibilidade ap√≥s 500ms sem digita√ß√£o
            subdominioTimeout = setTimeout(async () => {
              subdominioStatus.innerHTML = '<span style="color: var(--gray-600);"><i class="ti ti-hourglass"></i> Verificando disponibilidade...</span>';
              
              try {
                const token = localStorage.getItem('oursales:auth-token');
                if (token) {
                  const response = await fetch(`${API_BASE}/configuracoes/verificar-subdominio?subdominio=${encodeURIComponent(subdominio)}`, {
                    method: 'GET',
                    headers: {
                      Authorization: `Bearer ${token}`,
                    },
                  });

                  const result = await response.json();
                  
                  if (response.ok) {
                    if (result.disponivel) {
                      subdominioStatus.innerHTML = '<span style="color: #10b981;"><i class="ti ti-check"></i> Subdom√≠nio dispon√≠vel</span>';
                    } else {
                      subdominioStatus.innerHTML = '<span style="color: #ef4444;"><i class="ti ti-x"></i> Este subdom√≠nio j√° est√° em uso</span>';
                    }
                  } else {
                    subdominioStatus.innerHTML = '<span style="color: #f59e0b;"><i class="ti ti-alert-triangle"></i> Erro ao verificar disponibilidade</span>';
                  }
                } else {
                  // Modo local - verificar no localStorage
                  const data = localStorage.getItem('oursales:data');
                  if (data) {
                    const parsed = JSON.parse(data);
                    const subdominiosUsados = parsed.subdominiosUsados || [];
                    if (subdominiosUsados.includes(subdominio)) {
                      subdominioStatus.innerHTML = '<span style="color: #ef4444;"><i class="ti ti-x"></i> Este subdom√≠nio j√° est√° em uso</span>';
                    } else {
                      subdominioStatus.innerHTML = '<span style="color: #10b981;"><i class="ti ti-check"></i> Subdom√≠nio dispon√≠vel</span>';
                    }
                  } else {
                    subdominioStatus.innerHTML = '<span style="color: #10b981;"><i class="ti ti-check"></i> Subdom√≠nio dispon√≠vel</span>';
                  }
                }
              } catch (error) {
                subdominioStatus.innerHTML = '<span style="color: #f59e0b;"><i class="ti ti-alert-triangle"></i> Erro ao verificar disponibilidade</span>';
              }
            }, 500);
          });
        }

        // Carregar dados existentes
        async function carregarDados() {
          const token = localStorage.getItem('oursales:auth-token');
          
          if (token) {
            try {
              const response = await fetch(`${API_BASE}/configuracoes/dados-cadastrais`, {
                method: 'GET',
                headers: {
                  Authorization: `Bearer ${token}`,
                },
              });

              if (response.ok) {
                const dados = await response.json();
                preencherFormulario(dados);
              }
            } catch (error) {
              console.error('Erro ao carregar dados:', error);
            }
          } else {
            // Modo local
            const data = localStorage.getItem('oursales:data');
            if (data) {
              const parsed = JSON.parse(data);
              if (parsed.dadosCadastrais) {
                preencherFormulario(parsed.dadosCadastrais);
              }
            }
          }
        }

        // Preencher formul√°rio
        function preencherFormulario(dados) {
          if (dados.subdominio && subdominioInput) {
            subdominioInput.value = dados.subdominio;
          }
          if (dados.nomeFantasia) {
            document.getElementById('nomeFantasia').value = dados.nomeFantasia;
          }
          if (dados.razaoSocial) {
            document.getElementById('razaoSocial').value = dados.razaoSocial;
          }
          if (dados.cnpj) {
            cnpjInput.value = dados.cnpj;
          }
          if (dados.inscricaoEstadual) {
            document.getElementById('inscricaoEstadual').value = dados.inscricaoEstadual;
          }
          if (dados.inscricaoMunicipal) {
            document.getElementById('inscricaoMunicipal').value = dados.inscricaoMunicipal;
          }
          if (dados.endereco) {
            document.getElementById('endereco').value = dados.endereco;
          }
          if (dados.numero) {
            document.getElementById('numero').value = dados.numero;
          }
          if (dados.bairro) {
            document.getElementById('bairro').value = dados.bairro;
          }
          if (dados.cep) {
            cepInput.value = dados.cep;
          }
          if (dados.cidade) {
            document.getElementById('cidade').value = dados.cidade;
          }
          if (dados.estado) {
            document.getElementById('estado').value = dados.estado;
          }
          if (dados.emailCobranca) {
            document.getElementById('emailCobranca').value = dados.emailCobranca;
          }
          if (dados.website) {
            document.getElementById('website').value = dados.website;
          }
          if (dados.telefone) {
            telefoneInput.value = dados.telefone;
          }
          if (dados.fax) {
            faxInput.value = dados.fax;
          }
        }

        // Submiss√£o do formul√°rio
        form.addEventListener('submit', async function (e) {
          e.preventDefault();

          const formData = {
            subdominio: subdominioInput?.value.trim().toLowerCase() || '',
            nomeFantasia: document.getElementById('nomeFantasia').value.trim(),
            razaoSocial: document.getElementById('razaoSocial').value.trim(),
            cnpj: cnpjInput.value.replace(/\D/g, ''),
            inscricaoEstadual: document.getElementById('inscricaoEstadual').value.trim(),
            inscricaoMunicipal: document.getElementById('inscricaoMunicipal').value.trim(),
            endereco: document.getElementById('endereco').value.trim(),
            numero: document.getElementById('numero').value.trim(),
            bairro: document.getElementById('bairro').value.trim(),
            cep: cepInput.value.replace(/\D/g, ''),
            cidade: document.getElementById('cidade').value.trim(),
            estado: document.getElementById('estado').value,
            emailCobranca: document.getElementById('emailCobranca').value.trim(),
            website: document.getElementById('website').value.trim(),
            telefone: telefoneInput.value.replace(/\D/g, ''),
            fax: faxInput.value.replace(/\D/g, ''),
          };

          const token = localStorage.getItem('oursales:auth-token');

          if (!token) {
            // Salvar localmente
            const storage = {
              load: () => {
                const data = localStorage.getItem('oursales:data');
                return data ? JSON.parse(data) : {};
              },
              save: (data) => {
                localStorage.setItem('oursales:data', JSON.stringify(data));
              },
            };

            const data = storage.load();
            data.dadosCadastrais = {
              ...formData,
              atualizadoEm: new Date().toISOString(),
            };

            // Atualizar lista de subdom√≠nios usados
            if (!data.subdominiosUsados) {
              data.subdominiosUsados = [];
            }
            if (formData.subdominio && !data.subdominiosUsados.includes(formData.subdominio)) {
              data.subdominiosUsados.push(formData.subdominio);
            }

            storage.save(data);
            alert('Dados cadastrais salvos com sucesso!');
            window.location.reload();
          } else {
            // Salvar via API
            try {
              const response = await fetch(`${API_BASE}/configuracoes/dados-cadastrais`, {
                method: 'PUT',
                headers: {
                  'Content-Type': 'application/json',
                  Authorization: `Bearer ${token}`,
                },
                body: JSON.stringify(formData),
              });

              const result = await response.json();

              if (response.ok) {
                alert('Dados cadastrais salvos com sucesso!');
                window.location.reload();
              } else {
                alert(`Erro ao salvar: ${result.message || 'Erro desconhecido'}`);
              }
            } catch (error) {
              alert(`Erro ao salvar dados: ${error.message}`);
            }
          }
        });

        // Carregar dados ao inicializar
        carregarDados();
      }

      // Navega√ß√£o do menu
      document.addEventListener('DOMContentLoaded', () => {
        // Carregar importar produtos
        initImportarProdutos();

        // Verificar se h√° se√ß√£o na URL
        const hash = window.location.hash.replace('#', '');
        const defaultSection = hash || 'importar-produtos';

        // Ativar se√ß√£o padr√£o
        showSection(defaultSection);
        
        // Se a se√ß√£o padr√£o for importar-industrias ou importar-contatos, inicializar
        if (defaultSection === 'importar-industrias') {
          setTimeout(() => {
            initImportarIndustrias();
          }, 200);
        }
        if (defaultSection === 'importar-contatos') {
          setTimeout(() => {
            initImportarContatos();
          }, 200);
        }
        if (defaultSection === 'importar-faturamento') {
          setTimeout(() => {
            initImportarFaturamento();
          }, 200);
        }
        if (defaultSection === 'importar-fotos') {
          setTimeout(() => {
            initImportarFotos();
          }, 200);
        }
        if (defaultSection === 'importar-formas-pagamento') {
          setTimeout(() => {
            initImportarFormasPagamento();
          }, 200);
        }
        if (defaultSection === 'importar-transportadoras') {
          setTimeout(() => {
            initImportarTransportadoras();
          }, 200);
        }
        if (defaultSection === 'importar-pedido-rapido') {
          setTimeout(() => {
            initImportarPedidoRapido();
          }, 200);
        }
        if (defaultSection === 'importar-grupo-conta') {
          setTimeout(() => {
            initImportarGrupoConta();
          }, 200);
        }
        if (defaultSection === 'dados-cadastrais') {
          setTimeout(() => {
            initDadosCadastrais();
          }, 200);
        }

        // Event listeners do menu
        document.querySelectorAll('.config-menu-link').forEach(link => {
          link.addEventListener('click', (e) => {
            const section = link.getAttribute('data-section');
            const href = link.getAttribute('href');
            
            // Se n√£o tem data-section e tem href externo, permitir navega√ß√£o normal
            if (!section && href && !href.startsWith('#')) {
              return; // Deixar navega√ß√£o normal
            }
            
            e.preventDefault();
            if (section) {
              showSection(section);
              window.history.pushState(null, '', `#${section}`);
            }
          });
        });

        // Verificar permiss√µes de gerente
        checkManagerPermissions();
      });

      function showSection(sectionId) {
        // Esconder todas as se√ß√µes
        document.querySelectorAll('.config-section').forEach(section => {
          section.classList.remove('active');
        });

        // Remover active de todos os links
        document.querySelectorAll('.config-menu-link').forEach(link => {
          link.classList.remove('active');
        });

        // Mostrar se√ß√£o selecionada
        const section = document.getElementById(sectionId);
        if (section) {
          section.classList.add('active');
          
          // Inicializar funcionalidades espec√≠ficas da se√ß√£o
          if (sectionId === 'importar-industrias') {
            setTimeout(() => {
              initImportarIndustrias();
            }, 100);
          }
          if (sectionId === 'importar-contatos') {
            setTimeout(() => {
              initImportarContatos();
            }, 100);
          }
          if (sectionId === 'importar-faturamento') {
            setTimeout(() => {
              initImportarFaturamento();
            }, 100);
          }
          if (sectionId === 'importar-fotos') {
            setTimeout(() => {
              initImportarFotos();
            }, 100);
          }
          if (sectionId === 'importar-formas-pagamento') {
            setTimeout(() => {
              initImportarFormasPagamento();
            }, 100);
          }
          if (sectionId === 'importar-transportadoras') {
            setTimeout(() => {
              initImportarTransportadoras();
            }, 100);
          }
          if (sectionId === 'importar-pedido-rapido') {
            setTimeout(() => {
              initImportarPedidoRapido();
            }, 100);
          }
          if (sectionId === 'importar-grupo-conta') {
            setTimeout(() => {
              initImportarGrupoConta();
            }, 100);
          }
          if (sectionId === 'alterar-senha') {
            setTimeout(() => {
              initAlterarSenha();
            }, 100);
          }
          if (sectionId === 'configurar-financeiro') {
            setTimeout(() => {
              initConfigurarFinanceiro();
            }, 100);
          }
          if (sectionId === 'dados-cadastrais') {
            setTimeout(() => {
              initDadosCadastrais();
            }, 100);
          }
        }

        // Ativar link correspondente
        const link = document.querySelector(`[data-section="${sectionId}"]`);
        if (link) {
          link.classList.add('active');
        }
      }

      function checkManagerPermissions() {
        // Verifica√ß√£o de permiss√µes removida - acesso liberado para todos
        // TODO: Implementar verifica√ß√£o de permiss√µes quando o sistema de autentica√ß√£o estiver pronto
      }

      // Inicializar Alterar Senha
      let alterarSenhaInitialized = false;
      function initAlterarSenha() {
        if (alterarSenhaInitialized) return;
        alterarSenhaInitialized = true;

        const API_BASE = 'http://localhost:3000/api';
        const form = document.getElementById('formAlterarSenha');
        const novaSenhaInput = document.getElementById('novaSenha');
        const confirmarSenhaInput = document.getElementById('confirmarSenha');
        const senhaMatchMessage = document.getElementById('senhaMatchMessage');

        if (!form || !novaSenhaInput || !confirmarSenhaInput) {
          alterarSenhaInitialized = false;
          return;
        }

        // Valida√ß√£o de confirma√ß√£o de senha em tempo real
        function validarSenhas() {
          const novaSenhaVal = novaSenhaInput.value;
          const confirmarSenhaVal = confirmarSenhaInput.value;

          if (confirmarSenhaVal && novaSenhaVal !== confirmarSenhaVal) {
            confirmarSenhaInput.setCustomValidity('As senhas n√£o coincidem');
            if (senhaMatchMessage) {
              senhaMatchMessage.style.display = 'block';
            }
            confirmarSenhaInput.style.borderColor = 'var(--error)';
            return false;
          } else {
            confirmarSenhaInput.setCustomValidity('');
            if (senhaMatchMessage) {
              senhaMatchMessage.style.display = 'none';
            }
            confirmarSenhaInput.style.borderColor = '';
            return true;
          }
        }

        novaSenhaInput.addEventListener('input', validarSenhas);
        confirmarSenhaInput.addEventListener('input', validarSenhas);

        // Submiss√£o do formul√°rio
        form.addEventListener('submit', async function (e) {
          e.preventDefault();

          if (!validarSenhas()) {
            return;
          }

          const formData = {
            senhaAtual: document.getElementById('senhaAtual').value,
            novaSenha: novaSenhaInput.value,
            confirmarSenha: confirmarSenhaInput.value,
          };

          const token = localStorage.getItem('oursales:auth-token');

          if (!token) {
            alert('Funcionalidade dispon√≠vel apenas com autentica√ß√£o. Por favor, fa√ßa login no sistema.');
            return;
          }

          // Salvar via API
          try {
            const response = await fetch(`${API_BASE}/auth/alterar-senha`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                Authorization: `Bearer ${token}`,
              },
              body: JSON.stringify(formData),
            });

            const result = await response.json();

            if (response.ok) {
              alert('Senha alterada com sucesso!');
              form.reset();
            } else {
              alert(`Erro ao alterar senha: ${result.message || 'Erro desconhecido'}`);
            }
          } catch (error) {
            alert(`Erro ao alterar senha: ${error.message}`);
          }
        });
      }

      // Inicializar Configurar Financeiro
      let configurarFinanceiroInitialized = false;
      function initConfigurarFinanceiro() {
        if (configurarFinanceiroInitialized) return;
        configurarFinanceiroInitialized = true;

        const API_BASE = 'http://localhost:3000/api';
        const form = document.getElementById('formConfigurarFinanceiro');
        const grupoContaComissoes = document.getElementById('grupoContaComissoes');
        const grupoContaRecebiveis = document.getElementById('grupoContaRecebiveis');

        if (!form) {
          configurarFinanceiroInitialized = false;
          return;
        }

        // Carregar grupos de conta (simulado - substituir por API real)
        async function carregarGruposConta() {
          const token = localStorage.getItem('oursales:auth-token');
          
          try {
            let grupos = [];
            if (token) {
              const response = await fetch(`${API_BASE}/grupos-conta`, {
                headers: {
                  Authorization: `Bearer ${token}`,
                },
              });
              if (response.ok) {
                grupos = await response.json();
              }
            } else {
              // Modo local
              const data = localStorage.getItem('oursales:data');
              if (data) {
                const parsed = JSON.parse(data);
                grupos = parsed.gruposConta || [];
              }
            }

            // Preencher selects
            grupos.forEach(grupo => {
              const option1 = document.createElement('option');
              option1.value = grupo.id || grupo.codigo;
              option1.textContent = grupo.descricao || grupo.nome;
              grupoContaComissoes?.appendChild(option1);

              const option2 = document.createElement('option');
              option2.value = grupo.id || grupo.codigo;
              option2.textContent = grupo.descricao || grupo.nome;
              grupoContaRecebiveis?.appendChild(option2);
            });
          } catch (error) {
            console.error('Erro ao carregar grupos de conta:', error);
          }
        }

        // Carregar dados existentes
        async function carregarDados() {
          const token = localStorage.getItem('oursales:auth-token');
          
          try {
            let dados = {};
            if (token) {
              const response = await fetch(`${API_BASE}/configuracoes/financeiro`, {
                headers: {
                  Authorization: `Bearer ${token}`,
                },
              });
              if (response.ok) {
                dados = await response.json();
              }
            } else {
              // Modo local
              const data = localStorage.getItem('oursales:data');
              if (data) {
                const parsed = JSON.parse(data);
                dados = parsed.configuracaoFinanceiro || {};
              }
            }

            // Preencher formul√°rio
            if (dados.permitirGerarReceitasComissoes !== undefined) {
              document.getElementById('permitirGerarReceitasComissoes').checked = dados.permitirGerarReceitasComissoes;
            }
            if (dados.permitirGerarReceitasRecebiveis !== undefined) {
              document.getElementById('permitirGerarReceitasRecebiveis').checked = dados.permitirGerarReceitasRecebiveis;
            }
            if (dados.grupoContaComissoes) {
              grupoContaComissoes.value = dados.grupoContaComissoes;
            }
            if (dados.grupoContaRecebiveis) {
              grupoContaRecebiveis.value = dados.grupoContaRecebiveis;
            }
          } catch (error) {
            console.error('Erro ao carregar dados:', error);
          }
        }

        // Submiss√£o do formul√°rio
        form.addEventListener('submit', async function (e) {
          e.preventDefault();

          const formData = {
            permitirGerarReceitasComissoes: document.getElementById('permitirGerarReceitasComissoes').checked,
            permitirGerarReceitasRecebiveis: document.getElementById('permitirGerarReceitasRecebiveis').checked,
            grupoContaComissoes: grupoContaComissoes.value || null,
            grupoContaRecebiveis: grupoContaRecebiveis.value || null,
          };

          const token = localStorage.getItem('oursales:auth-token');

          if (!token) {
            // Salvar localmente
            const storage = {
              load: () => {
                const data = localStorage.getItem('oursales:data');
                return data ? JSON.parse(data) : {};
              },
              save: (data) => {
                localStorage.setItem('oursales:data', JSON.stringify(data));
              },
            };

            const data = storage.load();
            data.configuracaoFinanceiro = {
              ...formData,
              atualizadoEm: new Date().toISOString(),
            };

            storage.save(data);
            alert('Configura√ß√µes financeiras salvas com sucesso!');
            return;
          }

          // Salvar via API
          try {
            const response = await fetch(`${API_BASE}/configuracoes/financeiro`, {
              method: 'PUT',
              headers: {
                'Content-Type': 'application/json',
                Authorization: `Bearer ${token}`,
              },
              body: JSON.stringify(formData),
            });

            const result = await response.json();

            if (response.ok) {
              alert('Configura√ß√µes financeiras salvas com sucesso!');
            } else {
              alert(`Erro ao salvar: ${result.message || 'Erro desconhecido'}`);
            }
          } catch (error) {
            alert(`Erro ao salvar configura√ß√µes: ${error.message}`);
          }
        });

        // Carregar dados
        carregarGruposConta().then(() => {
          carregarDados();
        });
      }

      // Atualizar conte√∫do quando hash mudar
      window.addEventListener('hashchange', () => {
        const hash = window.location.hash.replace('#', '');
        if (hash) {
          showSection(hash);
        }
      });
    </script>

  </body>
</html>
